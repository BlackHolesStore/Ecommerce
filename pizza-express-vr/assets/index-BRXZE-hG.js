import{r as e,a as t,R as o}from"./react-vendor-DENY9G7l.js";import{C as n,M as i,a as r,B as a,V as s,L as l,b as d,G as p,c,d as u,R as h,e as x,D as f,S as m,f as g,g as y,h as b,i as z,j as v,k as w,F as S,P as j,W as D,l as k,A as T,m as M,n as E,o as R,p as C}from"./three-C_z_WGl4.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var P={exports:{}},I={},A=e,B=Symbol.for("react.element"),F=Symbol.for("react.fragment"),L=Object.prototype.hasOwnProperty,W=A.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,o){var n,i={},r=null,a=null;for(n in void 0!==o&&(r=""+o),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(a=t.ref),t)L.call(t,n)&&!$.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:B,type:e,key:r,ref:a,props:i,_owner:W.current}}I.Fragment=F,I.jsx=N,I.jsxs=N,P.exports=I;var O=P.exports,H={},_=t;H.createRoot=_.createRoot,H.hydrateRoot=_.hydrateRoot;const G=[{x:-15,z:10,label:"A"},{x:15,z:10,label:"B"},{x:-15,z:-12,label:"C"},{x:15,z:-12,label:"D"}],V=[{x:-40,z:40,num:1},{x:40,z:40,num:2},{x:-40,z:-40,num:3},{x:40,z:-40,num:4}],q=0,X=4,Y=[{id:1,title:"Welcome to Pizza Express VR!",message:"You are a drone pilot delivering pizzas across the city!",highlight:null},{id:2,title:"Pick Up Pizza",message:"First, grab a pizza from the shop. Keep it level!",highlight:"shop"},{id:3,title:"Carry Carefully",message:"Tilt meter shows pizza condition. Keep it green!",highlight:"tiltMeter"},{id:4,title:"Select Your Drone",message:"Match the drone letter to your order.",highlight:"droneSelect"},{id:5,title:"Fly to Destination",message:"Use WASD to move, Space/Shift for altitude.",highlight:"controls"},{id:6,title:"Deliver!",message:"Land in the green zone and release the pizza!",highlight:"deliveryZone"}],K=8900331,U=4881468,J=16729156,Z=16776960,Q=3355443,ee=2201331,te=65280,oe=4473924,ne=2236962,ie=16750848,re=16739179,ae=async()=>{if(!navigator.xr)return{supported:!1,reason:"WebXR not available in this browser"};try{const e=await navigator.xr.isSessionSupported("immersive-vr");return{supported:e,reason:e?"VR supported":"immersive-vr not supported"}}catch(e){return{supported:!1,reason:e.message}}};class se{constructor(e,t,o){this.renderer=e,this.scene=t,this.camera=o,this.session=null,this.referenceSpace=null,this.controllers=[],this.controllerGrips=[],this.isInVR=!1,this.controllerState={left:{connected:!1,squeezing:!1,selecting:!1,thumbstick:{x:0,y:0}},right:{connected:!1,squeezing:!1,selecting:!1,thumbstick:{x:0,y:0}}},this.onSessionStart=null,this.onSessionEnd=null,this.onControllerInput=null}async init(){const e=await ae();return e.supported?(this.renderer.xr.enabled=!0,this.setupControllers(),!0):(console.warn("WebXR not supported:",e.reason),!1)}setupControllers(){const e=this.renderer.xr.getController(0);e.userData.handedness="left",this.setupControllerEvents(e,0),this.scene.add(e),this.controllers.push(e);const t=this.renderer.xr.getController(1);t.userData.handedness="right",this.setupControllerEvents(t,1),this.scene.add(t),this.controllers.push(t);const o=this.renderer.xr.getControllerGrip(0);this.scene.add(o),this.controllerGrips.push(o);const n=this.renderer.xr.getControllerGrip(1);this.scene.add(n),this.controllerGrips.push(n),this.addControllerVisuals()}addControllerVisuals(){const e=new n(.01,.02,.1,8),t=new i({color:4491519,emissive:2245768,emissiveIntensity:.3});this.controllers.forEach((o,n)=>{const i=new r(e,t);i.rotation.x=-Math.PI/2,o.add(i);const p=(new a).setFromPoints([new s(0,0,0),new s(0,0,-5)]),c=new l({color:4521864,transparent:!0,opacity:.5}),u=new d(p,c);o.add(u)})}setupControllerEvents(e,t){const o=0===t?"left":"right";e.addEventListener("connected",t=>{this.controllerState[o].connected=!0,e.userData.inputSource=t.data,t.data.handedness&&(e.userData.handedness=t.data.handedness),console.log(`Controller ${o} connected:`,t.data.handedness)}),e.addEventListener("disconnected",()=>{this.controllerState[o].connected=!1,console.log(`Controller ${o} disconnected`)}),e.addEventListener("selectstart",()=>{this.controllerState[o].selecting=!0,this.onControllerInput&&this.onControllerInput({type:"selectstart",hand:o,controller:e})}),e.addEventListener("selectend",()=>{this.controllerState[o].selecting=!1,this.onControllerInput&&this.onControllerInput({type:"selectend",hand:o,controller:e})}),e.addEventListener("squeezestart",()=>{this.controllerState[o].squeezing=!0,this.onControllerInput&&this.onControllerInput({type:"squeezestart",hand:o,controller:e})}),e.addEventListener("squeezeend",()=>{this.controllerState[o].squeezing=!1,this.onControllerInput&&this.onControllerInput({type:"squeezeend",hand:o,controller:e})})}async startSession(){try{const e={requiredFeatures:["local-floor"],optionalFeatures:["bounded-floor","hand-tracking","layers"]};return this.session=await navigator.xr.requestSession("immersive-vr",e),this.isInVR=!0,this.renderer.xr.setSession(this.session),this.referenceSpace=await this.session.requestReferenceSpace("local-floor"),this.session.addEventListener("end",()=>{this.isInVR=!1,this.session=null,this.onSessionEnd&&this.onSessionEnd()}),this.onSessionStart&&this.onSessionStart(),console.log("VR session started"),!0}catch(e){return console.error("Failed to start VR session:",e),!1}}async endSession(){this.session&&await this.session.end()}pollControllerInput(){if(!this.session)return;const e=this.session.inputSources;for(const t of e){if(!t.gamepad)continue;const e=t.handedness||"unknown";if("left"!==e&&"right"!==e)continue;const o=t.gamepad;o.axes.length>=4&&(this.controllerState[e].thumbstick={x:o.axes[2]||0,y:o.axes[3]||0}),o.buttons.length>4&&(this.controllerState[e].primaryButton=o.buttons[4]?.pressed||!1,this.controllerState[e].secondaryButton=o.buttons[5]?.pressed||!1)}return this.controllerState}async triggerHaptic(e,t=.5,o=100){if(!this.session)return;const n=this.session.inputSources;for(const r of n)if(r.handedness===e&&r.gamepad){const e=r.gamepad;if(e.vibrationActuator)try{return void(await e.vibrationActuator.playEffect("dual-rumble",{startDelay:0,duration:o,weakMagnitude:.5*t,strongMagnitude:t}))}catch(i){}if(e.hapticActuators&&e.hapticActuators[0])try{await e.hapticActuators[0].pulse(t,o)}catch(i){}}}getControllerPosition(e){const t="left"===e?0:1,o=this.controllers[t];if(!o)return null;const n=new s;return o.getWorldPosition(n),n}getControllerDirection(e){const t="left"===e?0:1,o=this.controllers[t];if(!o)return null;const n=new s(0,0,-1);return o.getWorldDirection(n),n}}const le=[{name:"Plain Cheese",price:12.99,emoji:"üßÄ",description:"Lucky you! Just a basic cheese pizza."},{name:"Pepperoni",price:14.99,emoji:"üçï",description:"Classic pepperoni - not too bad."},{name:"Hawaiian",price:15.99,emoji:"üçç",description:"Pineapple lovers hate you now."},{name:"Veggie Supreme",price:16.99,emoji:"ü•¨",description:"All those veggies... wasted!"},{name:"Meat Lovers",price:18.99,emoji:"ü•ì",description:"So much meat... gone forever."},{name:"BBQ Chicken",price:17.99,emoji:"üçó",description:"That BBQ sauce is everywhere now!"},{name:"Supreme Deluxe",price:21.99,emoji:"üëë",description:"The EXPENSIVE one! Boss is MAD!"},{name:"Truffle Special",price:24.99,emoji:"üçÑ",description:"TRUFFLE?! That costs a fortune!"},{name:"Lobster & Gold Leaf",price:49.99,emoji:"ü¶û",description:"OH NO! The $50 LUXURY PIZZA! You're in DEEP trouble!"}],de=[{id:"cheese_lover",name:"Cheese Lover",emoji:"üßÄ",description:"Delivered 25 Plain Cheese pizzas",pizzaType:"Plain Cheese",required:25},{id:"cheese_king",name:"Cheese King",emoji:"üßÄüëë",description:"Delivered 100 Plain Cheese pizzas",pizzaType:"Plain Cheese",required:100},{id:"pepperoni_pro",name:"Pepperoni Pro",emoji:"üçï",description:"Delivered 25 Pepperoni pizzas",pizzaType:"Pepperoni",required:25},{id:"pepperoni_legend",name:"Pepperoni Legend",emoji:"üçïüî•",description:"Delivered 100 Pepperoni pizzas",pizzaType:"Pepperoni",required:100},{id:"hawaiian_hero",name:"Hawaiian Hero",emoji:"üçç",description:"Delivered 25 Hawaiian pizzas",pizzaType:"Hawaiian",required:25},{id:"pineapple_defender",name:"Pineapple Defender",emoji:"üççüõ°Ô∏è",description:"Delivered 100 Hawaiian pizzas - You embrace the controversy!",pizzaType:"Hawaiian",required:100},{id:"veggie_friend",name:"Veggie Friend",emoji:"ü•¨",description:"Delivered 25 Veggie Supreme pizzas",pizzaType:"Veggie Supreme",required:25},{id:"green_machine",name:"Green Machine",emoji:"ü•¨üíö",description:"Delivered 100 Veggie Supreme pizzas",pizzaType:"Veggie Supreme",required:100},{id:"carnivore",name:"Carnivore",emoji:"ü•ì",description:"Delivered 25 Meat Lovers pizzas",pizzaType:"Meat Lovers",required:25},{id:"meat_master",name:"Meat Master",emoji:"ü•ìüèÜ",description:"Delivered 100 Meat Lovers pizzas",pizzaType:"Meat Lovers",required:100},{id:"bbq_boss",name:"BBQ Boss",emoji:"üçó",description:"Delivered 25 BBQ Chicken pizzas",pizzaType:"BBQ Chicken",required:25},{id:"grill_master",name:"Grill Master",emoji:"üçóüî•",description:"Delivered 100 BBQ Chicken pizzas",pizzaType:"BBQ Chicken",required:100},{id:"supreme_server",name:"Supreme Server",emoji:"üëë",description:"Delivered 25 Supreme Deluxe pizzas",pizzaType:"Supreme Deluxe",required:25},{id:"deluxe_deity",name:"Deluxe Deity",emoji:"üëë‚ú®",description:"Delivered 100 Supreme Deluxe pizzas",pizzaType:"Supreme Deluxe",required:100},{id:"truffle_hunter",name:"Truffle Hunter",emoji:"üçÑ",description:"Delivered 15 Truffle Special pizzas",pizzaType:"Truffle Special",required:15},{id:"truffle_tycoon",name:"Truffle Tycoon",emoji:"üçÑüíé",description:"Delivered 50 Truffle Special pizzas",pizzaType:"Truffle Special",required:50},{id:"luxury_courier",name:"Luxury Courier",emoji:"ü¶û",description:"Delivered 10 Lobster & Gold Leaf pizzas",pizzaType:"Lobster & Gold Leaf",required:10},{id:"golden_god",name:"Golden God",emoji:"ü¶ûüåü",description:"Delivered 25 Lobster & Gold Leaf pizzas - The elite!",pizzaType:"Lobster & Gold Leaf",required:25}],pe=[{id:"first_delivery",name:"First Flight",emoji:"üõ´",description:"Completed your first delivery!",deliveries:1},{id:"getting_started",name:"Getting Started",emoji:"üì¶",description:"Completed 10 deliveries",deliveries:10},{id:"on_a_roll",name:"On a Roll",emoji:"üéØ",description:"Completed 50 deliveries",deliveries:50},{id:"century",name:"Century Club",emoji:"üíØ",description:"Completed 100 deliveries",deliveries:100},{id:"pizza_veteran",name:"Pizza Veteran",emoji:"üéñÔ∏è",description:"Completed 250 deliveries",deliveries:250},{id:"delivery_legend",name:"Delivery Legend",emoji:"üèÜ",description:"Completed 500 deliveries",deliveries:500},{id:"pizza_immortal",name:"Pizza Immortal",emoji:"‚ö°",description:"Completed 1000 deliveries",deliveries:1e3}],ce=[{id:"first_perfect",name:"Flawless",emoji:"‚≠ê",description:"First perfect delivery!",perfectDeliveries:1},{id:"perfectionist",name:"Perfectionist",emoji:"üåü",description:"10 perfect deliveries",perfectDeliveries:10},{id:"untouchable",name:"Untouchable",emoji:"üí´",description:"50 perfect deliveries",perfectDeliveries:50},{id:"god_tier",name:"God Tier",emoji:"‚ú®",description:"100 perfect deliveries - You are a master!",perfectDeliveries:100}],ue=[{id:"speed_demon",name:"Speed Demon",emoji:"‚ö°",description:"Delivered in under 20 seconds",fastestTime:20},{id:"lightning",name:"Lightning Fast",emoji:"üå©Ô∏è",description:"Delivered in under 15 seconds",fastestTime:15},{id:"time_bender",name:"Time Bender",emoji:"‚è±Ô∏è",description:"Delivered in under 10 seconds - Are you hacking?!",fastestTime:10}],he=[{id:"first_hundred",name:"First $100",emoji:"üíµ",description:"Earned $100 in tips",totalTips:100},{id:"high_roller",name:"High Roller",emoji:"üí∞",description:"Earned $500 in tips",totalTips:500},{id:"tip_tycoon",name:"Tip Tycoon",emoji:"ü§ë",description:"Earned $1000 in tips",totalTips:1e3},{id:"pizza_millionaire",name:"Pizza Millionaire",emoji:"üíé",description:"Earned $5000 in tips - Rolling in dough!",totalTips:5e3}],xe=["James","Mary","John","Patricia","Robert","Jennifer","Michael","Linda","David","Elizabeth","William","Barbara","Richard","Susan","Joseph","Jessica","Thomas","Sarah","Christopher","Karen","Charles","Lisa","Daniel","Nancy","Matthew","Betty","Anthony","Margaret","Mark","Sandra","Donald","Ashley","Steven","Kimberly","Paul","Emily","Andrew","Donna","Joshua","Michelle","Kevin","Dorothy","Brian","Carol","George","Amanda","Timothy","Melissa","Ronald","Deborah","Jason","Stephanie","Edward","Rebecca","Jeffrey","Sharon","Ryan","Laura","Jacob","Cynthia","Gary","Kathleen","Nicholas","Amy","Eric","Angela","Jonathan","Shirley","Stephen","Anna","Larry","Brenda","Justin","Pamela","Scott","Emma","Brandon","Nicole","Benjamin","Helen","Samuel","Samantha","Gregory","Katherine","Alexander","Christine","Frank","Debra","Patrick","Rachel","Raymond","Carolyn","Jack","Janet","Dennis","Catherine","Jerry","Maria","Tyler","Heather"],fe=["Smith","Johnson","Williams","Brown","Jones","Garcia","Miller","Davis","Rodriguez","Martinez","Hernandez","Lopez","Gonzalez","Wilson","Anderson","Thomas","Taylor","Moore","Jackson","Martin","Lee","Perez","Thompson","White","Harris","Sanchez","Clark","Ramirez","Lewis","Robinson","Walker","Young","Allen","King","Wright","Scott","Torres","Nguyen","Hill","Flores","Green","Adams","Nelson","Baker","Hall","Rivera","Campbell","Mitchell","Carter","Roberts","Gomez","Phillips","Evans","Turner","Diaz","Parker","Cruz","Edwards","Collins","Reyes","Stewart","Morris","Morales","Murphy","Cook","Rogers","Gutierrez","Ortiz","Morgan","Cooper","Peterson","Bailey","Reed","Kelly","Howard","Ramos","Kim","Cox","Ward","Richardson","Watson","Brooks","Chavez","Wood","James","Bennett","Gray","Mendoza","Ruiz","Hughes","Price","Alvarez","Castillo","Sanders","Patel","Myers","Long","Ross","Foster","Jimenez"],me=[{name:"Trainee",emoji:"üê£",minXP:0,tipBonus:0,color:"#888888"},{name:"Rookie Pilot",emoji:"üõ´",minXP:100,tipBonus:.05,color:"#66bb6a"},{name:"Delivery Driver",emoji:"üöó",minXP:300,tipBonus:.1,color:"#42a5f5"},{name:"Pizza Pro",emoji:"üçï",minXP:600,tipBonus:.15,color:"#ab47bc"},{name:"Sky Captain",emoji:"‚úàÔ∏è",minXP:1e3,tipBonus:.2,color:"#ff7043"},{name:"Elite Flyer",emoji:"ü¶Ö",minXP:1500,tipBonus:.25,color:"#ffd54f"},{name:"Pizza Master",emoji:"üë®‚Äçüç≥",minXP:2200,tipBonus:.3,color:"#e91e63"},{name:"Drone Legend",emoji:"üèÜ",minXP:3e3,tipBonus:.35,color:"#ff9800"},{name:"Pizza Emperor",emoji:"üëë",minXP:4e3,tipBonus:.4,color:"#f44336"},{name:"PIZZA GOD",emoji:"üåü",minXP:5500,tipBonus:.5,color:"#ffd700"}],ge=e=>{for(let t=me.length-1;t>=0;t--)if(e>=me[t].minXP)return me[t];return me[0]},ye=(e,t,o,n,i)=>{if(i)return-150;let r=0;return e>=4.8?(r=50,n&&(r=75)):r=e>=4.5?40:e>=4?30:e>=3.5?20:e>=3?10:e>=2.5?0:e>=2?-25:-50,o<30&&r>0?r+=15:o<45&&r>0?r+=10:o<60&&r>0&&(r+=5),o>=90?(r=Math.min(r,0),r-=30):o>=120&&(r-=50),t<70?r-=20:t<50&&(r-=40),r<0&&(r=Math.floor(1.5*r)),r},be=(e,t,o)=>{if(e.name===t.name)return null;if(o){const e=[`üéâ PROMOTED to ${t.emoji} ${t.name}! Tips +${Math.round(100*t.tipBonus)}%!`,`üìà RANK UP! You're now a ${t.emoji} ${t.name}! More tips incoming!`,`üåü NICE! ${t.emoji} ${t.name} unlocked! +${Math.round(100*t.tipBonus)}% tip bonus!`,`üöÄ LEVEL UP! Welcome to ${t.emoji} ${t.name}! Tips are getting BIGGER!`];return e[Math.floor(Math.random()*e.length)]}{const e=[`üìâ DEMOTED to ${t.emoji} ${t.name}... Tips reduced to +${Math.round(100*t.tipBonus)}%`,`üò∞ RANK DOWN! Back to ${t.emoji} ${t.name}. Gotta do better!`,`üíî OUCH! Dropped to ${t.emoji} ${t.name}. Less tips now...`,`üîª Demoted to ${t.emoji} ${t.name}. The grind continues...`];return e[Math.floor(Math.random()*e.length)]}},ze="pizzaExpress_totalWages",ve="pizzaExpress_totalDeliveries",we="pizzaExpress_totalDestroyed",Se="pizzaExpress_bestTime",je="pizzaExpress_playerName",De="pizzaExpress_xp",ke="pizzaExpress_badges",Te="pizzaExpress_pizzaTypeDeliveries",Me="pizzaExpress_perfectDeliveries",Ee="pizzaExpress_totalTips",Re="pizzaExpress_fastestDelivery",Ce={fastest_delivery:[{rank:1,name:"SpeedDemon",value:12.5,unit:"s"},{rank:2,name:"PizzaPro",value:14.2,unit:"s"},{rank:3,name:"DroneKing",value:15.8,unit:"s"},{rank:4,name:"FastFlyer",value:16.1,unit:"s"},{rank:5,name:"QuickPizza",value:17.3,unit:"s"}],most_deliveries:[{rank:1,name:"Grinder99",value:1523,unit:""},{rank:2,name:"NeverStop",value:1201,unit:""},{rank:3,name:"PizzaBot",value:998,unit:""},{rank:4,name:"Delivery4Life",value:876,unit:""},{rank:5,name:"DroneQueen",value:754,unit:""}],highest_tips:[{rank:1,name:"TipMaster",value:25420,unit:"$"},{rank:2,name:"BigTipper",value:21300,unit:"$"},{rank:3,name:"MoneyMaker",value:19800,unit:"$"},{rank:4,name:"CashKing",value:17650,unit:"$"},{rank:5,name:"RichPilot",value:15200,unit:"$"}],perfect_pizzas:[{rank:1,name:"SteadyHands",value:892,unit:""},{rank:2,name:"Perfectionist",value:756,unit:""},{rank:3,name:"NoSpill",value:623,unit:""},{rank:4,name:"CarefulOne",value:589,unit:""},{rank:5,name:"GentlePilot",value:512,unit:""}],most_destroyed_pizzas:[{rank:1,name:"PizzaDestroyer",value:247,unit:"üçïüíÄ"},{rank:2,name:"ButterFingers",value:198,unit:"üçïüíÄ"},{rank:3,name:"Clumsy_Carl",value:156,unit:"üçïüíÄ"},{rank:4,name:"OopsieDoopsie",value:134,unit:"üçïüíÄ"},{rank:5,name:"PizzaChaos",value:112,unit:"üçïüíÄ"}],best_rating:[{rank:1,name:"PerfectPilot",value:5,unit:"‚≠ê"},{rank:2,name:"SteadyEddy",value:4.9,unit:"‚≠ê"},{rank:3,name:"CarefulCarl",value:4.8,unit:"‚≠ê"},{rank:4,name:"GentleGina",value:4.7,unit:"‚≠ê"},{rank:5,name:"SmoothOp",value:4.6,unit:"‚≠ê"}],total_wages:[{rank:1,name:"MoneyMaker",value:1250.5,unit:"$"},{rank:2,name:"TipKing",value:980.25,unit:"$"},{rank:3,name:"PizzaPro",value:756,unit:"$"},{rank:4,name:"SteadyEarner",value:543.75,unit:"$"},{rank:5,name:"JustStarted",value:125,unit:"$"},{rank:6,name:"BreakingEven",value:0,unit:"$"},{rank:7,name:"OopsMyBad",value:-45.5,unit:"$"},{rank:8,name:"PizzaCrasher",value:-156.97,unit:"$"},{rank:9,name:"DestroyerOfPizzas",value:-378.9,unit:"$"},{rank:10,name:"OwesTheBoss",value:-892.45,unit:"$"}],daily_earnings:[{rank:1,name:"TodaysBest",value:450,unit:"$"},{rank:2,name:"DailyGrind",value:380,unit:"$"},{rank:3,name:"MorningRush",value:320,unit:"$"},{rank:4,name:"AfternoonAce",value:290,unit:"$"},{rank:5,name:"NightOwl",value:245,unit:"$"}]},Pe=(e,t)=>{let o=0;o=e>=99?3:e>=90?2.7:e>=80?2.4:e>=70?2:e>=60?1.5:e>=50?1:e>=40?.7:.5;let n=0;return n=t<30?2:t<45?1.7:t<60?1.3:t<90?.8:t<120?.3:0,Math.min(5,o+n)},Ie=({score:e,pizzasDelivered:t,pizzasDestroyed:o,currentOrder:n,pilotMode:i,cameraView:r,pizzaHealth:a,playerStats:s,dronePosition:l,currentPizzaType:d})=>{const p=n?V.find(e=>e.num===n.base):null,c=void 0!==s?.xp?(e=>{const t=ge(e),o=me.findIndex(e=>e.name===t.name);if(o>=me.length-1)return{nextRank:null,xpNeeded:0,progress:100};const n=me[o+1],i=e-t.minXP,r=n.minXP-t.minXP,a=Math.min(100,i/r*100);return{nextRank:n,xpNeeded:n.minXP-e,progress:a}})(s.xp):null,u=s?.rank;return O.jsxs("div",{style:{position:"absolute",top:20,left:20,color:"white",fontFamily:"Arial, sans-serif",fontSize:"18px",background:"rgba(0,0,0,0.7)",padding:"15px",borderRadius:"10px",minWidth:"300px",backdropFilter:"blur(5px)"},children:[O.jsx("div",{style:{marginBottom:"10px",fontSize:"24px",fontWeight:"bold",color:"#FFD700"},children:"üçï Pizza Express VR"}),O.jsxs("div",{style:{color:e<0?"#ff4444":"#00ff00"},children:["üíµ Wages: ",e<0?`-$${Math.abs(e).toFixed(2)}`:`$${e.toFixed(2)}`,e<0&&O.jsx("span",{style:{fontSize:"12px",marginLeft:"5px"},children:"üò¨ IN DEBT!"})]}),O.jsxs("div",{children:["üì¶ Deliveries: ",t]}),o>0&&O.jsxs("div",{style:{color:"#ff6666"},children:["üíÄ Destroyed: ",o]}),O.jsxs("div",{style:{marginTop:"8px",padding:"8px",background:"rgba(255,255,255,0.1)",borderRadius:"5px"},children:[O.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[O.jsx("span",{style:{fontSize:"20px"},children:u?.emoji||"üê£"}),O.jsx("span",{style:{color:u?.color||"#888"},children:u?.name||"Trainee"}),u?.tipBonus>0&&O.jsxs("span",{style:{fontSize:"12px",background:"rgba(0,255,100,0.3)",padding:"2px 6px",borderRadius:"3px",color:"#00ff88"},children:["+",Math.round(100*u.tipBonus),"% tips"]})]}),c&&c.nextRank&&O.jsxs("div",{style:{marginTop:"5px"},children:[O.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10px",color:"#aaa",marginBottom:"2px"},children:[O.jsxs("span",{children:["XP: ",s.xp]}),O.jsxs("span",{children:["Next: ",c.nextRank.emoji," ",c.nextRank.name," (",c.xpNeeded," XP)"]})]}),O.jsx("div",{style:{height:"6px",background:"rgba(255,255,255,0.2)",borderRadius:"3px",overflow:"hidden"},children:O.jsx("div",{style:{height:"100%",width:`${c.progress}%`,background:`linear-gradient(90deg, ${u?.color||"#888"}, ${c.nextRank.color})`,borderRadius:"3px",transition:"width 0.3s ease"}})})]}),c&&!c.nextRank&&O.jsx("div",{style:{fontSize:"10px",color:"#ffd700",marginTop:"3px"},children:"üåü MAX RANK! PIZZA GOD!"})]}),n&&O.jsxs("div",{style:{marginTop:"10px",padding:"10px",background:"rgba(255,215,0,0.2)",borderRadius:"5px"},children:[O.jsx("div",{style:{fontWeight:"bold",color:"#FFD700"},children:"Current Order:"}),n.customerName&&O.jsxs("div",{style:{fontSize:"14px",color:"#00ff88",marginBottom:"5px"},children:["üë§ ",n.customerName]}),d&&O.jsxs("div",{style:{fontSize:"14px",color:d.price>=25?"#ff6666":"#ffcc00",marginBottom:"5px"},children:[d.emoji," ",d.name,O.jsxs("span",{style:{fontSize:"12px",marginLeft:"5px"},children:["($",d.price.toFixed(2),")"]}),d.price>=25&&O.jsx("span",{children:" ‚ö†Ô∏è"})]}),O.jsxs("div",{children:["üöÅ Drone: ",n.drone]}),O.jsxs("div",{children:["üè¢ Base: #",n.base]}),p&&O.jsxs("div",{style:{fontSize:"12px",color:"#aaa"},children:["üìç Rooftop: (",p.x,", ",p.z,")"]})]}),i&&l&&O.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"rgba(0,150,255,0.2)",borderRadius:"5px",fontSize:"14px"},children:[O.jsx("div",{style:{color:"#00aaff"},children:"üìç Drone Position:"}),O.jsxs("div",{children:["X: ",l.x?.toFixed(1)," | Z: ",l.z?.toFixed(1)]}),O.jsxs("div",{children:["Alt: ",l.y?.toFixed(1),"m"]}),p&&O.jsxs("div",{style:{marginTop:"5px",color:"#00ff88"},children:["üéØ Land on Roof: (",p.x,", ",p.z,")"]})]}),i&&O.jsxs("div",{style:{marginTop:"10px",fontSize:"14px",color:"#aaa"},children:["Camera: ","pov"===r?"POV":"overhead"===r?"Overhead":"Third Person"," (V to switch)"]})]})},Ae=({pizzaHealth:e,pizzaTilt:t})=>{const o=()=>e>=80?"#00ff00":e>=50?"#ffff00":e>=25?"#ff9900":"#ff0000",n=e<100;return O.jsxs("div",{style:{position:"absolute",bottom:80,left:20,background:n?"rgba(80,0,0,0.7)":"rgba(0,0,0,0.5)",padding:"8px 12px",borderRadius:"8px",color:"white",fontFamily:"Arial, sans-serif",border:n?"1px solid #ff4444":"1px solid #333",transition:"all 0.3s"},children:[O.jsx("div",{style:{fontSize:"10px",marginBottom:"4px",color:"#aaa"},children:"üçï PIZZA"}),O.jsx("div",{style:{width:"120px",height:"8px",background:"#333",borderRadius:"4px",overflow:"hidden"},children:O.jsx("div",{style:{width:`${e}%`,height:"100%",background:o(),transition:"width 0.2s"}})}),O.jsxs("div",{style:{fontSize:"10px",marginTop:"3px",display:"flex",justifyContent:"space-between"},children:[O.jsx("span",{style:{color:o()},children:e>=80?"‚úì Good":e>=50?"‚ö† Tilted":"‚ö† Damaged"}),O.jsxs("span",{style:{color:"#666"},children:[Math.round(e),"%"]})]})]})},Be=({speed:e,isWarning:t,pizzaHealth:o})=>{const n=Math.min(100,e/12*100),i=()=>e<7?"#00ff00":e<8.5?"#ffaa00":"#ff0000",r=e>=8.5;return O.jsxs("div",{style:{position:"absolute",bottom:20,left:20,background:r?"rgba(100,0,0,0.7)":"rgba(0,0,0,0.6)",padding:"8px 12px",borderRadius:"8px",color:"white",fontFamily:"Arial, sans-serif",border:r?"2px solid #ff0000":"1px solid #444",transition:"all 0.2s",minWidth:"140px"},children:[O.jsx("div",{style:{fontSize:"10px",marginBottom:"4px",color:"#aaa"},children:"üö∂ SPEED"}),O.jsx("div",{style:{width:"120px",height:"8px",background:"#333",borderRadius:"4px",overflow:"hidden",position:"relative"},children:O.jsx("div",{style:{width:`${n}%`,height:"100%",background:i(),transition:"width 0.1s"}})}),O.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"3px",fontSize:"10px"},children:[O.jsx("span",{style:{color:i(),fontWeight:"bold"},children:e<7?"‚úì SAFE":e<8.5?"‚ö† CAREFUL":"üî• TOO FAST!"}),O.jsx("span",{style:{color:"#666"},children:e.toFixed(1)})]})]})},Fe=({dronePosition:e,targetBase:t,currentOrder:o,altitude:n,verticalSpeed:i})=>{if(!e||!t)return null;const r=t.x-e.x,a=t.z-e.z,s=Math.max(-50,Math.min(50,2*r)),l=Math.max(-40,Math.min(40,2*a)),d=n||1.5,p=Math.min(100,d/50*100),c=i||0;return O.jsxs("div",{style:{position:"absolute",top:20,right:20,width:"220px",background:"rgba(0,0,0,0.85)",border:"2px solid #00ff00",borderRadius:"10px",padding:"10px"},children:[O.jsx("div",{style:{color:"#00ff00",fontSize:"12px",fontWeight:"bold",marginBottom:"5px",textAlign:"center"},children:"üì° GPS NAVIGATION"}),O.jsxs("div",{style:{display:"flex",gap:"10px"},children:[O.jsxs("div",{style:{position:"relative",width:"120px",height:"100px",background:"rgba(0,50,0,0.5)",borderRadius:"5px"},children:[O.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",width:"8px",height:"8px",background:"#00ff00",borderRadius:"50%",transform:"translate(-50%, -50%)",animation:"blink 1s infinite",boxShadow:"0 0 8px #00ff00"}}),O.jsx("div",{style:{position:"absolute",left:`calc(50% + ${s}px)`,top:`calc(50% + ${l}px)`,width:"10px",height:"10px",background:"#ff0000",borderRadius:"50%",transform:"translate(-50%, -50%)",border:"2px solid #fff",animation:"pulse 0.5s infinite"}}),O.jsx("svg",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"},children:O.jsx("line",{x1:"50%",y1:"50%",x2:`calc(50% + ${s}px)`,y2:`calc(50% + ${l}px)`,stroke:"#00ff00",strokeWidth:"1",strokeDasharray:"4,4",opacity:"0.5"})})]}),O.jsxs("div",{style:{width:"60px",display:"flex",flexDirection:"column",alignItems:"center"},children:[O.jsx("div",{style:{color:"#00ff00",fontSize:"10px",marginBottom:"3px"},children:"ALTITUDE"}),O.jsxs("div",{style:{width:"20px",height:"70px",background:"rgba(0,50,0,0.8)",border:"1px solid #00ff00",borderRadius:"3px",position:"relative",overflow:"hidden"},children:[O.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:`${p}%`,background:`linear-gradient(to top, #004400, ${d>30?"#ffaa00":"#00ff00"})`,transition:"height 0.1s"}}),[10,20,30,40].map(e=>O.jsx("div",{style:{position:"absolute",bottom:e/50*100+"%",left:0,right:0,borderTop:"1px dashed rgba(0,255,0,0.3)"}},e))]}),O.jsxs("div",{style:{color:"#00ff00",fontSize:"14px",fontWeight:"bold",marginTop:"3px"},children:[d.toFixed(1),"m"]}),O.jsxs("div",{style:{color:Math.abs(c)<.5?"#888888":c>0?"#00ff00":"#ff6600",fontSize:"16px",marginTop:"2px"},children:[Math.abs(c)<.5?"‚óè":c>0?"‚ñ≤":"‚ñº",O.jsx("span",{style:{fontSize:"10px",marginLeft:"2px"},children:Math.abs(c).toFixed(1)})]})]})]}),O.jsxs("div",{style:{color:"#00ff00",fontSize:"11px",textAlign:"center",marginTop:"5px"},children:["üéØ Base ",o?.base]})]})},Le=({distanceToBase:e,canRelease:t,canDescend:o,horizontalDist:n,altitude:i})=>{if(null===e||e>=50)return null;const r=t?{color:"#00ff00",message:"‚úì RELEASE ZONE",subMessage:"Press SPACE to Release Pizza!",pulse:!0}:o?{color:"#00ff00",message:"‚¨áÔ∏è DESCEND NOW",subMessage:`Centered! Land on roof (Alt: ${i?.toFixed(1)||"?"}m ‚Üí 7m)`,pulse:!0}:null!==n?n<5?{color:"#ffff00",message:`‚ÜîÔ∏è ${n.toFixed(1)}m off center`,subMessage:"Get directly OVER the beacon!",pulse:!1}:{color:"#ff9900",message:`üéØ ${Math.floor(e)}m to target`,subMessage:"Fly toward the beacon",pulse:!1}:{color:"#ff6600",message:`${Math.floor(e)}m`,subMessage:"Approach Base",pulse:!1};return O.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"42px",fontWeight:"bold",color:r.color,textShadow:"0 0 20px rgba(0,0,0,0.8)",animation:r.pulse?"pulse 0.5s infinite":"none",pointerEvents:"none",textAlign:"center"},children:[r.message,O.jsx("div",{style:{fontSize:"16px",marginTop:"5px",color:r.color},children:r.subMessage})]})},We=({message:e})=>O.jsx("div",{style:{position:"absolute",bottom:120,left:"50%",transform:"translateX(-50%)",color:"white",fontFamily:"Arial, sans-serif",fontSize:"16px",background:"rgba(0,100,200,0.85)",padding:"12px 20px",borderRadius:"10px",maxWidth:"500px",textAlign:"center",backdropFilter:"blur(5px)"},children:e}),$e=({step:e,onNext:t,onSkip:o})=>{const n=Y[e];return n?O.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:100},children:O.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",padding:"30px",borderRadius:"15px",maxWidth:"450px",textAlign:"center",color:"white",border:"2px solid #00ff00",boxShadow:"0 0 30px rgba(0,255,0,0.3)"},children:[O.jsxs("div",{style:{fontSize:"14px",color:"#00ff00",marginBottom:"10px"},children:["Step ",e+1," of ",Y.length]}),O.jsx("h2",{style:{color:"#FFD700",marginBottom:"15px",fontSize:"24px"},children:n.title}),O.jsx("p",{style:{fontSize:"16px",lineHeight:"1.6",marginBottom:"25px"},children:n.message}),O.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[O.jsx("button",{onClick:o,style:{padding:"10px 20px",background:"#444",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px"},children:"Skip Tutorial"}),O.jsx("button",{onClick:t,style:{padding:"10px 30px",background:"#00ff00",color:"#000",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:e<Y.length-1?"Next ‚Üí":"Start Playing!"})]})]})}):null},Ne=()=>O.jsxs("div",{style:{position:"absolute",bottom:70,left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.8)",color:"white",padding:"10px 20px",borderRadius:"8px",fontFamily:"Arial, sans-serif",fontSize:"13px"},children:[O.jsx("span",{style:{color:"#FFD700"},children:"W"}),": Forward |",O.jsx("span",{style:{color:"#FFD700"},children:" S"}),": Back |",O.jsx("span",{style:{color:"#FFD700"},children:" A/D"}),": Turn |",O.jsx("span",{style:{color:"#FFD700"},children:" Space"}),": Up |",O.jsx("span",{style:{color:"#FFD700"},children:" Shift"}),": Down |",O.jsx("span",{style:{color:"#FFD700"},children:" V"}),": Camera"]}),Oe=({badge:e})=>e?O.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"linear-gradient(135deg, #4a1a6b 0%, #1a0a2e 100%)",padding:"30px",borderRadius:"20px",textAlign:"center",color:"white",border:"3px solid #9966ff",boxShadow:"0 0 50px #9966ff40, 0 0 100px #6633ff30",animation:"popIn 0.5s ease-out",zIndex:200,minWidth:"300px"},children:[O.jsx("div",{style:{fontSize:"14px",color:"#cc99ff",marginBottom:"10px"},children:"üéñÔ∏è NEW BADGE EARNED! üéñÔ∏è"}),O.jsx("div",{style:{fontSize:"60px",marginBottom:"10px"},children:e.emoji}),O.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ffd700",marginBottom:"10px"},children:e.name}),O.jsx("div",{style:{fontSize:"14px",color:"#cc99ff",fontStyle:"italic"},children:e.description})]}):null,He=({message:e})=>{if(!e)return null;const t=e.includes("PROMOTED")||e.includes("RANK UP");return O.jsx("div",{style:{position:"absolute",top:"25%",left:"50%",transform:"translate(-50%, -50%)",background:t?"linear-gradient(135deg, #1a4a2a 0%, #0a2e1a 100%)":"linear-gradient(135deg, #4a1a1a 0%, #2e0a0a 100%)",padding:"20px 40px",borderRadius:"15px",textAlign:"center",color:"white",border:"3px solid "+(t?"#00ff66":"#ff4444"),boxShadow:"0 0 30px "+(t?"#00ff6640":"#ff444440"),animation:"popIn 0.3s ease-out",zIndex:180,fontSize:"18px",fontWeight:"bold"},children:e})},_e=({isOpen:e,onClose:t,category:o,onCategoryChange:n,playerRank:i,playerScore:r})=>{if(!e)return null;const a=Ce[o]||[],s=e=>{switch(e){case"fastest_delivery":return"‚ö° Fastest Delivery";case"most_deliveries":return"üì¶ Most Deliveries";case"highest_tips":return"üí∞ Highest Tips";case"perfect_pizzas":return"‚≠ê Perfect Pizzas";case"most_destroyed_pizzas":return"üíÄ Most Destroyed";case"total_wages":return"üíµ Total Wages";case"daily_earnings":return"üìÖ Daily Earnings";default:return e}};return O.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:200},children:O.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a2e 0%, #0f0f23 100%)",padding:"25px",borderRadius:"15px",minWidth:"400px",maxWidth:"500px",color:"white",border:"2px solid #FFD700",boxShadow:"0 0 40px rgba(255,215,0,0.3)"},children:[O.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[O.jsx("h2",{style:{color:"#FFD700",margin:0,fontSize:"24px"},children:"üèÜ LEADERBOARDS"}),O.jsx("button",{onClick:t,style:{background:"transparent",border:"none",color:"#888",fontSize:"24px",cursor:"pointer"},children:"‚úï"})]}),O.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"20px"},children:Object.keys(Ce).map(e=>O.jsx("button",{onClick:()=>n(e),style:{padding:"8px 12px",background:o===e?"#FFD700":"#333",color:o===e?"#000":"#fff",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"12px",fontWeight:o===e?"bold":"normal"},children:s(e)},e))}),O.jsx("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"10px",padding:"15px"},children:a.map((e,t)=>O.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px",borderBottom:t<a.length-1?"1px solid #333":"none",background:t<3?"rgba(255,215,0,0.1)":"transparent"},children:[O.jsx("div",{style:{width:"35px",fontSize:"20px",textAlign:"center"},children:0===t?"ü•á":1===t?"ü•à":2===t?"ü•â":`#${e.rank}`}),O.jsx("div",{style:{flex:1,paddingLeft:"10px",fontWeight:t<3?"bold":"normal"},children:e.name}),O.jsx("div",{style:{color:e.value<0?"#ff4444":t<3?"#FFD700":"#aaa",fontWeight:"bold",fontSize:"16px"},children:"$"===e.unit?e.value<0?`-$${Math.abs(e.value).toLocaleString()}`:`$${e.value.toLocaleString()}`:"s"===e.unit?`${e.value}s`:e.value.toLocaleString()})]},t))}),i&&O.jsxs("div",{style:{marginTop:"15px",padding:"12px",background:"rgba(0,255,0,0.1)",borderRadius:"8px",border:"1px solid #00ff00",display:"flex",alignItems:"center"},children:[O.jsx("div",{style:{fontSize:"16px",marginRight:"10px"},children:"üìç"}),O.jsxs("div",{style:{flex:1},children:[O.jsx("div",{style:{fontSize:"12px",color:"#888"},children:"Your Position"}),O.jsxs("div",{style:{fontWeight:"bold"},children:["#",i]})]}),O.jsx("div",{style:{color:"#00ff00",fontWeight:"bold",fontSize:"18px"},children:r})]}),O.jsx("div",{style:{marginTop:"15px",fontSize:"11px",color:"#666",textAlign:"center"},children:"daily_earnings"===o?"‚è∞ Resets daily at midnight":"üîÑ Weekly reset every Sunday"})]})})},Ge=({topPlayers:e,playerRank:t,onExpand:o})=>O.jsxs("div",{style:{position:"absolute",bottom:20,right:20,background:"rgba(0,0,0,0.8)",padding:"12px",borderRadius:"10px",minWidth:"180px",color:"white",fontFamily:"Arial, sans-serif"},children:[O.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",borderBottom:"1px solid #333",paddingBottom:"8px"},children:[O.jsx("span",{style:{fontSize:"14px",fontWeight:"bold",color:"#FFD700"},children:"üèÜ Top Players"}),O.jsx("button",{onClick:o,style:{background:"transparent",border:"1px solid #FFD700",color:"#FFD700",padding:"2px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"View All"})]}),e?.slice(0,3).map((e,t)=>O.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",padding:"3px 0",color:0===t?"#FFD700":"#aaa"},children:[O.jsxs("span",{children:[0===t?"ü•á":1===t?"ü•à":"ü•â"," ",e.name]}),O.jsx("span",{children:e.value})]},t)),t&&O.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #333",fontSize:"11px",color:"#00ff00"},children:["üìç You: #",t]})]}),Ve=({deliveryTime:e,tip:t,pizzaHealth:o,isPerfect:n,temperature:i,rating:r,tipMessage:a,pizzaType:s,xpChange:l,rankBonus:d,playerRank:p,totalDeliveries:c,onNextOrder:u,onViewLeaderboard:h})=>{const x=((e,t)=>{const o=(e>=99?3:e>=80?2.5:e>=60?2:e>=40?1:.5)+(t<30?2:t<45?1.5:t<60?1:t<90?.5:0);return o>=4.5?{label:"LEGENDARY",emoji:"üåüüåüüåüüåüüåü",color:"#FFD700"}:o>=4?{label:"EXCELLENT",emoji:"‚≠ê‚≠ê‚≠ê‚≠ê‚ú®",color:"#00ff00"}:o>=3.5?{label:"GREAT",emoji:"‚≠ê‚≠ê‚≠ê‚≠ê",color:"#88ff00"}:o>=3?{label:"GOOD",emoji:"‚≠ê‚≠ê‚≠ê‚ú®",color:"#ccff00"}:o>=2.5?{label:"OKAY",emoji:"‚≠ê‚≠ê‚≠ê",color:"#ffff00"}:o>=2?{label:"MEH",emoji:"‚≠ê‚≠ê‚ú®",color:"#ffcc00"}:o>=1.5?{label:"POOR",emoji:"‚≠ê‚≠ê",color:"#ff9900"}:o>=1?{label:"BAD",emoji:"‚≠ê‚ú®",color:"#ff6600"}:{label:"DISASTER",emoji:"üíÄ",color:"#ff0000"}})(o,e),f=i||{temp:e<30?"PIPING HOT":e<45?"HOT":e<60?"WARM":e<90?"LUKEWARM":"COLD",emoji:e<30?"üî•üî•üî•":e<45?"üî•üî•":e<60?"üî•":e<90?"üòê":"ü•∂",color:e<30?"#ff4400":e<45?"#ff6600":e<60?"#ff9900":e<90?"#ffcc00":"#0099ff"},m=0===t;return O.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:150},children:O.jsxs("div",{style:{background:m?"linear-gradient(135deg, #4a1a1a 0%, #2d0d0d 100%)":"linear-gradient(135deg, #1a472a 0%, #0d2818 100%)",padding:"30px",borderRadius:"20px",textAlign:"center",color:"white",border:`3px solid ${m?"#ff4444":x.color}`,boxShadow:"0 0 50px "+(m?"#ff444440":x.color+"40"),animation:"popIn 0.3s ease-out",minWidth:"400px"},children:[s&&O.jsxs("div",{style:{fontSize:"14px",color:"#ffcc00",marginBottom:"10px"},children:[s.emoji," ",s.name]}),O.jsx("div",{style:{fontSize:"50px",marginBottom:"5px"},children:m?"üò§":n?"üåü":o>=80?"‚úÖ":o>=50?"üòÖ":"üò¨"}),O.jsx("h2",{style:{color:m?"#ff4444":x.color,fontSize:"28px",marginBottom:"5px"},children:m?"DELIVERY... COMPLETE?":n?"PERFECT DELIVERY!":"DELIVERY COMPLETE!"}),O.jsxs("div",{style:{background:"rgba(0,0,0,0.4)",padding:"15px",borderRadius:"12px",marginBottom:"15px"},children:[O.jsx("div",{style:{fontSize:"32px",letterSpacing:"3px",marginBottom:"5px"},children:x.emoji}),O.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:x.color,letterSpacing:"2px"},children:x.label})]}),O.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",marginBottom:"15px"},children:[O.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"10px",borderRadius:"8px"},children:[O.jsx("div",{style:{fontSize:"11px",color:"#888"},children:"‚è±Ô∏è Time"}),O.jsxs("div",{style:{fontSize:"18px",fontWeight:"bold"},children:[e.toFixed(1),"s"]})]}),O.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"10px",borderRadius:"8px"},children:[O.jsx("div",{style:{fontSize:"11px",color:"#888"},children:"üçï Condition"}),O.jsxs("div",{style:{fontSize:"18px",fontWeight:"bold",color:o>=80?"#00ff00":o>=50?"#ffcc00":"#ff6600"},children:[Math.round(o),"%"]})]}),O.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"10px",borderRadius:"8px"},children:[O.jsx("div",{style:{fontSize:"11px",color:"#888"},children:"üå°Ô∏è Temp"}),O.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:f.color},children:f.emoji}),O.jsx("div",{style:{fontSize:"10px",color:f.color},children:f.temp})]})]}),O.jsx("div",{style:{fontSize:m?"28px":"36px",fontWeight:"bold",color:m?"#ff4444":"#FFD700",marginBottom:"5px"},children:m?"üò§ NO TIP!":`üí∞ +$${t.toFixed(2)} TIP!`}),a&&O.jsxs("div",{style:{fontSize:"14px",color:m?"#ff9999":t<3?"#ffcc99":"#99ff99",marginBottom:"10px",fontStyle:"italic",padding:"8px",background:"rgba(0,0,0,0.3)",borderRadius:"8px"},children:["üí¨ ",a]}),O.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"15px",marginBottom:"15px"},children:[void 0!==l&&0!==l&&O.jsxs("div",{style:{background:l>0?"rgba(0,255,100,0.2)":"rgba(255,0,0,0.2)",border:"1px solid "+(l>0?"#00ff66":"#ff4444"),padding:"8px 15px",borderRadius:"8px"},children:[O.jsx("div",{style:{fontSize:"11px",color:"#888"},children:"‚≠ê XP"}),O.jsxs("div",{style:{fontSize:"18px",fontWeight:"bold",color:l>0?"#00ff66":"#ff4444"},children:[l>0?"+":"",l]})]}),d>0&&O.jsxs("div",{style:{background:"rgba(255,215,0,0.2)",border:"1px solid #FFD700",padding:"8px 15px",borderRadius:"8px"},children:[O.jsx("div",{style:{fontSize:"11px",color:"#888"},children:"üëë Rank Bonus"}),O.jsxs("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#FFD700"},children:["+",Math.round(100*d),"%"]})]})]}),p&&O.jsx("div",{style:{background:"rgba(100,50,200,0.2)",border:"1px solid #9966ff",padding:"8px 15px",borderRadius:"8px",marginBottom:"10px"},children:O.jsxs("div",{style:{fontSize:"16px",color:"#cc99ff"},children:[p.emoji," ",p.name]})}),O.jsxs("div",{style:{fontSize:"14px",color:"#888",marginBottom:"20px"},children:["Total Deliveries: ",c]}),O.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[O.jsx("button",{onClick:h,style:{padding:"12px 24px",background:"#333",color:"#FFD700",border:"1px solid #FFD700",borderRadius:"8px",cursor:"pointer",fontSize:"14px"},children:"üèÜ Leaderboard"}),O.jsx("button",{onClick:u,style:{padding:"12px 30px",background:"#00ff00",color:"#000",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"16px",fontWeight:"bold"},children:"Next Order ‚Üí"})]})]})})},qe={primary:{padding:"15px 30px",fontSize:"18px",fontWeight:"bold",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",boxShadow:"0 4px 8px rgba(0,0,0,0.3)",transition:"all 0.2s ease"},secondary:{padding:"12px 24px",fontSize:"16px",fontWeight:"bold",background:"#555",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},danger:{padding:"15px 30px",fontSize:"18px",fontWeight:"bold",background:"#FF5722",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"}},Xe=()=>{const t=e.useRef(null),[o,a]=e.useState("menu"),[l,d]=e.useState(null),[P,I]=e.useState(0),[A,B]=e.useState(0),[F,L]=e.useState(0),[W,$]=e.useState("Welcome to Pizza Express VR!"),[N,H]=e.useState(!1),[_,Xe]=e.useState(null),[Ye,Ke]=e.useState("third"),[Ue,Je]=e.useState(null),[Ze,Qe]=e.useState(!1),[et,tt]=e.useState(!1),[ot,nt]=e.useState(null),[it,rt]=e.useState("ascending"),[at,st]=e.useState(!1),[lt,dt]=e.useState(null),[pt,ct]=e.useState(!1),[ut,ht]=e.useState(!1),[xt,ft]=e.useState(null),[mt,gt]=e.useState(null),[yt,bt]=e.useState(100),[zt,vt]=e.useState({x:0,z:0}),[wt,St]=e.useState(!1),[jt,Dt]=e.useState(0),[kt,Tt]=e.useState(!1),[Mt,Et]=e.useState("fastest_delivery"),[Rt,Ct]=e.useState(!1),[Pt,It]=e.useState(null),[At,Bt]=e.useState(null),[Ft,Lt]=e.useState({totalDeliveries:0,totalEarnings:0,destroyedPizzas:0,bestTime:null,rank:me[0],xp:0,level:1,badges:[],pizzaTypeDeliveries:{},perfectDeliveries:0,totalTips:0,fastestDelivery:null}),[Wt,$t]=e.useState(null),[Nt,Ot]=e.useState(null),[Ht,_t]=e.useState(!1),[Gt,Vt]=e.useState(!1),[qt,Xt]=e.useState(!1),Yt=e.useRef(null),Kt=e.useRef(100),Ut=e.useRef(!1),Jt=e.useRef({scene:null,camera:null,renderer:null,drones:[],bases:[],pizzaShop:null,currentDrone:null,pizzaAttached:!1,controls:{forward:!1,back:!1,left:!1,right:!1,up:!1,down:!1},lastDroneVelocity:{x:0,y:0,z:0},xrManager:null,vrButton:null,player:null,playerPizza:null,playerControls:{forward:!1,back:!1,left:!1,right:!1},lastPlayerVelocity:{x:0,z:0},sustainedSpeed:0,lastMoveTime:0,moveAccumulator:0}),[Zt,Qt]=e.useState({x:0,y:0,z:10}),[eo,to]=e.useState(null),[oo,no]=e.useState(!1),[io,ro]=e.useState(1.5),[ao,so]=e.useState(0),[lo,po]=e.useState(0),[co,uo]=e.useState(!1);e.useEffect(()=>{Ut.current=N},[N]),e.useEffect(()=>{const e=(()=>{try{const e=parseInt(localStorage.getItem(De))||0,t=ge(e),o=localStorage.getItem(ke),n=localStorage.getItem(Te);return{totalWages:parseFloat(localStorage.getItem(ze))||0,totalDeliveries:parseInt(localStorage.getItem(ve))||0,totalDestroyed:parseInt(localStorage.getItem(we))||0,bestTime:parseFloat(localStorage.getItem(Se))||null,playerName:localStorage.getItem(je)||"Rookie Pilot",xp:e,rank:t,badges:o?JSON.parse(o):[],pizzaTypeDeliveries:n?JSON.parse(n):{},perfectDeliveries:parseInt(localStorage.getItem(Me))||0,totalTips:parseFloat(localStorage.getItem(Ee))||0,fastestDelivery:parseFloat(localStorage.getItem(Re))||null}}catch(e){return console.warn("Could not load persistent data:",e),{totalWages:0,totalDeliveries:0,totalDestroyed:0,bestTime:null,playerName:"Rookie Pilot",xp:0,rank:me[0],badges:[],pizzaTypeDeliveries:{},perfectDeliveries:0,totalTips:0,fastestDelivery:null}}})();I(e.totalWages),B(e.totalDeliveries),L(e.totalDestroyed);const t=ge(e.xp);Lt(o=>({...o,totalDeliveries:e.totalDeliveries,totalEarnings:e.totalWages,destroyedPizzas:e.totalDestroyed,bestTime:e.bestTime,xp:e.xp,rank:t,badges:e.badges||[],pizzaTypeDeliveries:e.pizzaTypeDeliveries||{},perfectDeliveries:e.perfectDeliveries||0,totalTips:e.totalTips||0,fastestDelivery:e.fastestDelivery||null})),_t(!0),e.totalWages<0?$(`üí∏ Welcome back! You owe the shop $${Math.abs(e.totalWages).toFixed(2)}. Time to work it off!`):t.tipBonus>0&&$(`${t.emoji} Welcome back, ${t.name}! +${Math.round(100*t.tipBonus)}% tip bonus!`)},[]),e.useEffect(()=>{Ht&&(e=>{try{void 0!==e.totalWages&&localStorage.setItem(ze,e.totalWages.toString()),void 0!==e.totalDeliveries&&localStorage.setItem(ve,e.totalDeliveries.toString()),void 0!==e.totalDestroyed&&localStorage.setItem(we,e.totalDestroyed.toString()),void 0!==e.bestTime&&null!==e.bestTime&&localStorage.setItem(Se,e.bestTime.toString()),void 0!==e.playerName&&localStorage.setItem(je,e.playerName),void 0!==e.xp&&localStorage.setItem(De,e.xp.toString()),void 0!==e.badges&&localStorage.setItem(ke,JSON.stringify(e.badges)),void 0!==e.pizzaTypeDeliveries&&localStorage.setItem(Te,JSON.stringify(e.pizzaTypeDeliveries)),void 0!==e.perfectDeliveries&&localStorage.setItem(Me,e.perfectDeliveries.toString()),void 0!==e.totalTips&&localStorage.setItem(Ee,e.totalTips.toString()),void 0!==e.fastestDelivery&&null!==e.fastestDelivery&&localStorage.setItem(Re,e.fastestDelivery.toString())}catch(t){console.warn("Could not save persistent data:",t)}})({totalWages:P,totalDeliveries:A,totalDestroyed:F,bestTime:Ft.bestTime,xp:Ft.xp,badges:Ft.badges,pizzaTypeDeliveries:Ft.pizzaTypeDeliveries,perfectDeliveries:Ft.perfectDeliveries,totalTips:Ft.totalTips,fastestDelivery:Ft.fastestDelivery})},[P,A,F,Ft.bestTime,Ft.xp,Ft.badges,Ft.pizzaTypeDeliveries,Ft.perfectDeliveries,Ft.totalTips,Ft.fastestDelivery,Ht]),e.useEffect(()=>{if(!t.current)return;const e=new v;e.background=new w(K),e.fog=new S(K,50,200);const o=new j(75,window.innerWidth/window.innerHeight,.1,1e3);o.position.set(0,15,30),o.lookAt(0,0,0);const a=new D({antialias:!0,powerPreference:"high-performance",alpha:!1});a.setSize(window.innerWidth,window.innerHeight),a.setPixelRatio(Math.min(window.devicePixelRatio,2)),a.shadowMap.enabled=!0,a.shadowMap.type=k,a.xr.enabled=!0,t.current.appendChild(a.domElement);(async()=>{const n=await ae();if(Vt(n.supported),n.supported){const n=new se(a,e,o);await n.init(),n.onControllerInput=e=>{"selectstart"===e.type&&N&&zo(),"squeezestart"===e.type&&l&&!Ut.current&&bo(l.drone)},Yt.current=n,Jt.current.xrManager=n;const i=((e,t,o)=>{const n=document.createElement("button");return n.style.cssText="\n    position: absolute;\n    bottom: 20px;\n    left: 50%;\n    transform: translateX(-50%);\n    padding: 15px 30px;\n    border: none;\n    border-radius: 8px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    font-size: 16px;\n    font-weight: bold;\n    cursor: pointer;\n    z-index: 1000;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);\n  ",n.onmouseover=()=>{n.style.transform="translateX(-50%) scale(1.05)",n.style.boxShadow="0 6px 20px rgba(102, 126, 234, 0.6)"},n.onmouseout=()=>{n.style.transform="translateX(-50%) scale(1)",n.style.boxShadow="0 4px 15px rgba(102, 126, 234, 0.4)"},(async()=>{if(!(await ae()).supported)return n.textContent="üö´ VR Not Supported",n.disabled=!0,n.style.background="#666",void(n.style.cursor="not-allowed");n.textContent="ü•Ω Enter VR",n.onclick=async()=>{if(e.xr.isPresenting)await e.xr.getSession().end(),n.textContent="ü•Ω Enter VR",o&&o();else try{const i=await navigator.xr.requestSession("immersive-vr",{requiredFeatures:["local-floor"],optionalFeatures:["bounded-floor","hand-tracking","layers"]});e.xr.setSession(i),n.textContent="‚ùå Exit VR",t&&t(),i.addEventListener("end",()=>{n.textContent="ü•Ω Enter VR",o&&o()})}catch(i){console.error("Failed to start VR:",i)}}})(),n})(a,()=>Xt(!0),()=>Xt(!1));i.id="vr-button",t.current.appendChild(i),Jt.current.vrButton=i}})();const d=new T(16777215,.6);e.add(d);const z=new M(16777215,.8);z.position.set(50,50,50),z.castShadow=!0,z.shadow.mapSize.width=2048,z.shadow.mapSize.height=2048,z.shadow.camera.near=.5,z.shadow.camera.far=500,z.shadow.camera.left=-50,z.shadow.camera.right=50,z.shadow.camera.top=50,z.shadow.camera.bottom=-50,e.add(z);const P=new E(200,200),I=new i({color:U}),A=new r(P,I);A.rotation.x=-Math.PI/2,A.receiveShadow=!0,e.add(A);const B=new R(200,40,0,5592405);e.add(B);const F=(()=>{const e=new p,t=new c(6,4,6),o=new i({color:J}),n=new r(t,o);n.position.y=2,n.castShadow=!0,e.add(n);const a=new u(5,2,4),s=new i({color:13382451}),l=new r(a,s);l.position.y=5,l.rotation.y=Math.PI/4,e.add(l);const d=new c(7,1,.2),m=new i({color:Z}),g=new r(d,m);g.position.set(0,5,3.1),e.add(g);const y=new c(1.5,2.5,.1),b=new i({color:9127187}),z=new r(y,b);z.position.set(0,1.25,3.05),e.add(z);const v=new c(1,1,.1),w=new i({color:8900331,transparent:!0,opacity:.6});[-1.5,1.5].forEach(t=>{const o=new r(v,w);o.position.set(t,2.5,3.05),e.add(o)});const S=new c(2,1,1),j=new i({color:9127187}),D=new r(S,j);D.position.set(0,.5,2),D.castShadow=!0,e.add(D);const k=new h(1,1.5,32),T=new x({color:65280,transparent:!0,opacity:.7,side:f}),M=new r(k,T);M.rotation.x=-Math.PI/2,M.position.set(0,.05,4),M.userData.isPickupTrigger=!0,e.add(M);const E=new u(.3,.6,8),R=new x({color:65280}),C=new r(E,R);C.position.set(0,2.5,4),C.rotation.x=Math.PI,e.add(C);const P=new c(1.5,.4,.1),I=new i({color:43520}),A=new r(P,I);return A.position.set(0,3.2,4),e.add(A),e})();e.add(F),Jt.current.pizzaShop=F,G.forEach(t=>{const o=(()=>{const e=new p,t=new n(3,3,.3,32),o=new i({color:Q}),a=new r(t,o);a.position.y=.15,a.receiveShadow=!0,e.add(a);const s=new h(2,2.2,32),l=new x({color:16776960,side:f}),d=new r(s,l);return d.rotation.x=-Math.PI/2,d.position.y=.31,e.add(d),e})();o.position.set(t.x,0,t.z),e.add(o);const a=(()=>{const e=new p,t=new c(1.5,.3,1.5),o=new i({color:oe}),a=new r(t,o);a.castShadow=!0,e.add(a),[{x:.8,z:.8},{x:-.8,z:.8},{x:.8,z:-.8},{x:-.8,z:-.8}].forEach(t=>{const o=new n(.05,.05,.8,8),a=new i({color:ne}),s=new r(o,a);s.position.set(t.x,0,t.z),e.add(s);const l=new n(.5,.5,.05,32),d=new i({color:ie,transparent:!0,opacity:.7}),p=new r(l,d);p.position.set(t.x,.5,t.z),p.userData.isRotor=!0,e.add(p)});const s=new m(.1,16,16),l=new x({color:65280}),d=new r(s,l);return d.position.set(0,.2,.7),d.userData.isLED=!0,e.add(d),e})(t.label);a.position.set(t.x,1.5,t.z),a.userData={label:t.label,homePos:new s(t.x,1.5,t.z),hasPizza:!1,targetBase:null},e.add(a),Jt.current.drones.push(a);const l=((e,t="#ffffff",o=2)=>{const n=document.createElement("canvas"),i=n.getContext("2d");n.width=128,n.height=128,i.fillStyle=t,i.font="bold 80px Arial",i.textAlign="center",i.textBaseline="middle",i.fillText(e,64,64);const r=new g(n),a=new y({map:r}),s=new b(a);return s.scale.set(o,o,1),s})(t.label);l.position.set(t.x,4,t.z),e.add(l)}),V.forEach(t=>{const o=(e=>{const t=new p,o=6.5,a=new n(.3,.8,30,16,1,!0),s=new x({color:65416,transparent:!0,opacity:.15,side:f}),l=new r(a,s);l.position.set(0,21.5,0),l.userData.isBeacon=!0,l.visible=!1,t.add(l),[15,22,30,40].forEach((e,n)=>{const i=new h(2-.2*n,2.5-.2*n,32),a=new x({color:65416,transparent:!0,opacity:.4-.08*n,side:f}),s=new r(i,a);s.rotation.x=-Math.PI/2,s.position.set(0,o+e,0),s.userData.isHalo=!0,s.visible=!1,t.add(s)});const d=new m(.6,16,16),u=new x({color:65280,transparent:!0,opacity:.8}),z=new r(d,u);z.position.set(0,51.5,0),z.userData.isPulsingMarker=!0,z.visible=!1,t.add(z),t.userData.landingPadHeight=o;const v=new c(5,6,5),w=new i({color:ee}),S=new r(v,w);S.position.y=3,S.castShadow=!0,S.userData={baseNumber:e},t.add(S);const j=new c(5.5,.3,5.5),D=new i({color:1668818}),k=new r(j,D);k.position.y=6.15,t.add(k);const T=new n(.05,.05,1.5,8),M=new i({color:3355443}),E=new r(T,M);E.position.set(2,7,2),t.add(E);const R=new n(2,2,.2,32),C=new i({color:te}),P=new r(R,C);P.position.y=6.35,P.userData.isLandingPad=!0,t.add(P),[1.5,1,.5].forEach((e,o)=>{const n=new h(e-.05,e,32),i=new x({color:o%2==0?16777215:65280,side:f}),a=new r(n,i);a.rotation.x=-Math.PI/2,a.position.y=6.36,t.add(a)});const I=document.createElement("canvas"),A=I.getContext("2d");I.width=128,I.height=128,A.fillStyle="#ffffff",A.font="bold 80px Arial",A.textAlign="center",A.textBaseline="middle",A.fillText(e.toString(),64,64);const B=new g(I),F=new y({map:B}),L=new b(F);return L.position.y=8,L.scale.set(3,3,1),t.add(L),t})(t.num);o.position.set(t.x,0,t.z),o.userData={baseNumber:t.num},e.add(o),Jt.current.bases.push(o)});const L=new p,W=new C(.3,1,8,16),O=new i({color:4491519}),H=new r(W,O);H.position.y=1,H.castShadow=!0,L.add(H);const _=new u(.15,.3,8),Y=new x({color:16776960}),re=new r(_,Y);re.rotation.x=Math.PI/2,re.position.set(0,1,.5),L.add(re),L.position.set(0,0,12),L.rotation.y=Math.PI,L.userData.isPlayer=!0,e.add(L),Jt.current.player=L,o.position.set(0,6,20),o.lookAt(0,2,0),Jt.current.scene=e,Jt.current.camera=o,Jt.current.renderer=a,performance.now();a.setAnimationLoop((t,n)=>{if(Yt.current&&Yt.current.isInVR){const e=Yt.current.pollControllerInput();if(e&&N){const t=e.right.thumbstick,o=e.left.thumbstick;Math.abs(t.y)>.1?(Jt.current.controls.forward=t.y<-.1,Jt.current.controls.back=t.y>.1):(Jt.current.controls.forward=!1,Jt.current.controls.back=!1),Math.abs(t.x)>.1?(Jt.current.controls.right=t.x>.1,Jt.current.controls.left=t.x<-.1):(Jt.current.controls.left=!1,Jt.current.controls.right=!1),Math.abs(o.y)>.1?(Jt.current.controls.up=o.y<-.1,Jt.current.controls.down=o.y>.1):(Jt.current.controls.up=!1,Jt.current.controls.down=!1)}}Jt.current.drones.forEach(e=>{if(e.children.filter(e=>e.userData.isRotor).forEach(e=>{e.rotation.y+=.3}),Ut.current&&Jt.current.currentDrone===e){const t=Jt.current.controls,n=.3,i=.05,r=e.position.clone(),a=e.position.y;let s="cruising",d=!1;if(l){const t=Jt.current.bases.find(e=>e.userData.baseNumber===l.base);if(t){const o=t.position.x,n=t.position.z;d=Math.sqrt(Math.pow(e.position.x-o,2)+Math.pow(e.position.z-n,2))<1}}s=a<10&&!d?"ascending":d?"descending":"cruising",s!==it&&(rt(s),"ascending"===s?$("üöÅ ASCENDING - Reach 10m altitude to unlock controls!"):"cruising"===s?$(`‚úàÔ∏è CRUISING - Fly to Base ${l?.base}! Use WASD to navigate.`):"descending"===s&&$("üìç LANDING - Descend to drop zone! Press RELEASE when ready.")),"ascending"===s?(t.up&&(e.position.y+=1*n*1.5),t.left&&(e.rotation.y+=i),t.right&&(e.rotation.y-=i)):"cruising"===s?(t.forward&&(e.position.x+=Math.sin(e.rotation.y)*n,e.position.z+=Math.cos(e.rotation.y)*n),t.back&&(e.position.x-=Math.sin(e.rotation.y)*n,e.position.z-=Math.cos(e.rotation.y)*n),t.left&&(e.rotation.y+=i),t.right&&(e.rotation.y-=i),t.up&&(e.position.y+=1*n),t.down&&(e.position.y=Math.max(1.5,e.position.y-1*n))):"descending"===s&&(t.up&&(e.position.y+=1*n),t.down&&(e.position.y=Math.max(6.5,e.position.y-1*n)),t.left&&(e.rotation.y+=i),t.right&&(e.rotation.y-=i));const p={x:e.position.x-r.x,y:e.position.y-r.y,z:e.position.z-r.z};if(Jt.current.lastDroneVelocity=p,ro(e.position.y),so(60*p.y),l){const t=Jt.current.bases.find(e=>e.userData.baseNumber===l.base);if(t){const o=t.position.x,n=t.position.z,i=Math.sqrt(Math.pow(e.position.x-o,2)+Math.pow(e.position.z-n,2));nt(i);const r=Math.sqrt(Math.pow(e.position.x-o,2)+Math.pow(e.position.y,2)+Math.pow(e.position.z-n,2));Je(r);const a=i<1,s=e.position.y>=6&&e.position.y<=8,d=e.position.y>8;tt(a&&d),Qe(a&&s),Jt.current.bases.forEach(e=>{const t=e.userData.baseNumber===l.base;e.traverse(e=>{(e.userData.isBeacon||e.userData.isHalo||e.userData.isPulsingMarker)&&(e.visible=t,t&&e.material&&(a?(e.material.color.setHex(65280),e.material.opacity=e.userData.isPulsingMarker?1:.5):(e.material.color.setHex(65416),e.material.opacity=e.userData.isPulsingMarker?.8:.3)))})})}}else tt(!1),nt(null),Jt.current.bases.forEach(e=>{e.traverse(e=>{(e.userData.isBeacon||e.userData.isHalo||e.userData.isPulsingMarker)&&(e.visible=!1)})});ho(o,e,Ye)}});const i=Jt.current.player;if(i&&at&&!Ut.current){const e=Jt.current.playerControls,t=.15,n=.1,r=.05,a=i.position.clone();e.forward&&(i.position.x+=Math.sin(i.rotation.y)*t,i.position.z+=Math.cos(i.rotation.y)*t),e.back&&(i.position.x-=Math.sin(i.rotation.y)*n,i.position.z-=Math.cos(i.rotation.y)*n),e.left&&(i.rotation.y+=r),e.right&&(i.rotation.y-=r);const s=i.position.x-a.x,l=i.position.z-a.z,d=Math.sqrt(s*s+l*l),p=Date.now(),c=d>.001,u=p-Jt.current.lastMoveTime;c?(Jt.current.moveAccumulator=u<100?Math.min(2,Jt.current.moveAccumulator+.03):Math.max(0,Jt.current.moveAccumulator-.3),Jt.current.lastMoveTime=p):Jt.current.moveAccumulator=Math.max(0,Jt.current.moveAccumulator-.05);const h=d*(.5+Jt.current.moveAccumulator);Jt.current.sustainedSpeed=h,po(60*h),Jt.current.lastPlayerVelocity={x:s,z:l};const x=Jt.current.playerPizza;if(x){const e=2,t=Math.PI/4,o=.12,n=.14,r=l*Math.cos(i.rotation.y)+s*Math.sin(i.rotation.y),a=s*Math.cos(i.rotation.y)-l*Math.sin(i.rotation.y),d=Math.max(-t,Math.min(t,r*e*10)),p=Math.max(-t,Math.min(t,-a*e*10));x.rotation.x+=.08*(d-x.rotation.x),x.rotation.z+=.08*(p-x.rotation.z);const c=h>n;if(uo(h>o),c){const e=2*(h-n),t=Math.max(0,Kt.current-e);t!==Kt.current&&(Kt.current=t,bt(t),Yt.current?.isInVR&&(Yt.current.triggerHaptic("left",.3,50),Yt.current.triggerHaptic("right",.3,50)))}const u=Math.abs(x.rotation.x)+Math.abs(x.rotation.z);if(u>1.5*t){const e=.2*(u-1.5*t),o=Math.max(0,Kt.current-e);o!==Kt.current&&(Kt.current=o,bt(o),Yt.current?.isInVR&&(Yt.current.triggerHaptic("left",.6,100),Yt.current.triggerHaptic("right",.6,100)))}}Qt({x:i.position.x,z:i.position.z});let f=null,m=1/0;Jt.current.drones.forEach(e=>{const t=i.position.distanceTo(e.position);t<m&&(m=t,f=e)}),to(f&&m<3?f.userData.label:null),o.position.x=i.position.x-8*Math.sin(i.rotation.y),o.position.y=6,o.position.z=i.position.z-8*Math.cos(i.rotation.y),o.lookAt(i.position.x,1.5,i.position.z)}if(i&&!at&&!Ut.current){const e=Jt.current.playerControls,t=.18,n=.12,r=.06;e.forward&&(i.position.x+=Math.sin(i.rotation.y)*t,i.position.z+=Math.cos(i.rotation.y)*t),e.back&&(i.position.x-=Math.sin(i.rotation.y)*n,i.position.z-=Math.cos(i.rotation.y)*n),e.left&&(i.rotation.y+=r),e.right&&(i.rotation.y-=r),po(0),uo(!1);const a=Math.sqrt(Math.pow(i.position.x-q,2)+Math.pow(i.position.z-X,2));no(a<3),o.position.x=i.position.x-8*Math.sin(i.rotation.y),o.position.y=6,o.position.z=i.position.z-8*Math.cos(i.rotation.y),o.lookAt(i.position.x+5*Math.sin(i.rotation.y),1.5,i.position.z+5*Math.cos(i.rotation.y))}const r=.001*Date.now();Jt.current.bases.forEach(e=>{e.traverse(e=>{if(e.userData.isBeacon&&(e.material.opacity=.1+.08*Math.sin(2*r)),e.userData.isHalo&&(e.rotation.z+=.005,e.material.opacity=.25+.15*Math.sin(3*r+.5*e.position.y)),e.userData.isPulsingMarker){const t=.4+.4*Math.sin(4*r);e.material.opacity=t,e.scale.setScalar(.8+.3*Math.sin(3*r))}})}),a.render(e,o)});const le=e=>{const t=e.key.toLowerCase();Ut.current&&("w"===t&&(Jt.current.controls.forward=!0),"s"===t&&(Jt.current.controls.back=!0),"a"===t&&(Jt.current.controls.left=!0),"d"===t&&(Jt.current.controls.right=!0)," "===e.key&&(e.preventDefault(),Jt.current.controls.up=!0),"Shift"===e.key&&(Jt.current.controls.down=!0),"v"===t&&Ke(e=>"third"===e?"pov":"pov"===e?"overhead":"third")),Ut.current||("w"===t&&(Jt.current.playerControls.forward=!0),"s"===t&&(Jt.current.playerControls.back=!0),"a"===t&&(Jt.current.playerControls.left=!0),"d"===t&&(Jt.current.playerControls.right=!0))},de=e=>{const t=e.key.toLowerCase();"w"===t&&(Jt.current.controls.forward=!1),"s"===t&&(Jt.current.controls.back=!1),"a"===t&&(Jt.current.controls.left=!1),"d"===t&&(Jt.current.controls.right=!1)," "===e.key&&(Jt.current.controls.up=!1),"Shift"===e.key&&(Jt.current.controls.down=!1),"w"===t&&(Jt.current.playerControls.forward=!1),"s"===t&&(Jt.current.playerControls.back=!1),"a"===t&&(Jt.current.playerControls.left=!1),"d"===t&&(Jt.current.playerControls.right=!1)};window.addEventListener("keydown",le),window.addEventListener("keyup",de);const pe=()=>{o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)};return window.addEventListener("resize",pe),()=>{window.removeEventListener("keydown",le),window.removeEventListener("keyup",de),window.removeEventListener("resize",pe),a.setAnimationLoop(null),Jt.current.vrButton&&t.current&&t.current.removeChild(Jt.current.vrButton),t.current&&a.domElement&&t.current.removeChild(a.domElement),Yt.current?.session&&Yt.current.endSession()}},[l,Ye,at,o]),e.useEffect(()=>{if(yt<=0&&at){ct(!0),st(!1),L(e=>e+1);const e=ye(0,0,0,!1,!0);Lt(t=>{const o=Math.max(0,t.xp+e),n=t.rank,i=ge(o);if(n.name!==i.name){const e=be(n,i,!1);e&&setTimeout(()=>{Ot(e),setTimeout(()=>Ot(null),4e3)},2e3)}return{...t,destroyedPizzas:t.destroyedPizzas+1,xp:o,rank:i}}),Yt.current?.isInVR&&(Yt.current.triggerHaptic("left",1,300),Yt.current.triggerHaptic("right",1,300),setTimeout(()=>{Yt.current.triggerHaptic("left",.7,200),Yt.current.triggerHaptic("right",.7,200)},350));const t=Jt.current.player;t&&Jt.current.playerPizza&&(t.remove(Jt.current.playerPizza),Jt.current.playerPizza=null);const o=mt?.price||18.99;I(e=>e-o);let n="";n=o>=49.99?"ü¶û THE LOBSTER PIZZA?! Boss is going to FIRE you!":o>=24.99?"üçÑ A truffle pizza... that's coming out of your paycheck for WEEKS!":o>=21.99?"üëë The Supreme Deluxe! Management wants a word with you...":o<15?`üßÄ Lucky you - it was just ${mt?.name||"a cheap one"}!`:mt?.description||"That pizza is gone forever!",$(`üíÄ PIZZA DESTROYED! -$${o.toFixed(2)} | ${Math.abs(e)} XP lost! ${n}`)}},[yt,at,mt]);const ho=(e,t,o)=>{if("pov"===o){e.position.copy(t.position),e.position.y+=.3,e.position.x+=.2*Math.sin(t.rotation.y),e.position.z+=.2*Math.cos(t.rotation.y);const o=new s(t.position.x+50*Math.sin(t.rotation.y),t.position.y-2,t.position.z+50*Math.cos(t.rotation.y));e.lookAt(o),t.traverse(e=>{e.isMesh&&!e.userData.isRotor&&(e.material.transparent=!0,e.material.opacity=.3)})}else t.traverse(e=>{e.isMesh&&!e.userData.isRotor&&e.material.transparent&&(e.material.transparent=!1,e.material.opacity=1)}),"overhead"===o?(e.position.x=t.position.x,e.position.y=t.position.y+30,e.position.z=t.position.z+5,e.lookAt(t.position)):(e.position.x=t.position.x-12*Math.sin(t.rotation.y),e.position.y=t.position.y+5,e.position.z=t.position.z-12*Math.cos(t.rotation.y),e.lookAt(t.position))},xo=e.useCallback(()=>{const e=(()=>{const e=[25,20,15,12,10,8,5,4,1],t=e.reduce((e,t)=>e+t,0);let o=Math.random()*t;for(let n=0;n<e.length;n++)if(o-=e[n],o<=0)return le[n];return le[0]})(),t=`${xe[Math.floor(Math.random()*xe.length)]} ${fe[Math.floor(Math.random()*fe.length)]}`,o={drone:["A","B","C","D"][Math.floor(4*Math.random())],base:[1,2,3,4][Math.floor(4*Math.random())],pizzaType:e,customerName:t};d(o),gt(e),a("carrying"),$(`üçï ${e.emoji} ${e.name} ($${e.price.toFixed(2)}) for ${t}! Carry to Drone ${o.drone}`),H(!1),Xe(null),st(!1),bt(100),Kt.current=100,vt({x:0,z:0}),Ct(!1),Bt(Date.now())},[]),fo=e.useCallback(()=>{st(!1),bt(100),Kt.current=100,vt({x:0,z:0}),uo(!1),Jt.current&&(Jt.current.sustainedSpeed=0,Jt.current.moveAccumulator=0),$(`üçï Walk back to the shop to grab a new pizza for Drone ${l?.drone}!`)},[l]),mo=e.useCallback(()=>{if("carrying"!==o||at)return;const e=Jt.current.player;if(e&&Jt.current.scene){const t=new p,o=new c(.8,.15,.8),a=new i({color:13395507}),s=new r(o,a);s.castShadow=!0,t.add(s);const l=new n(.35,.35,.05,16),d=new i({color:16763904}),u=new r(l,d);u.position.y=.1,t.add(u);const h=new n(.05,.05,.02,8),x=new i({color:11149858});for(let e=0;e<8;e++){const o=new r(h,x),n=e/8*Math.PI*2,i=.15+.15*Math.random();o.position.set(Math.cos(n)*i,.13,Math.sin(n)*i),t.add(o)}t.position.set(0,1.2,.6),e.add(t),Jt.current.playerPizza=t}st(!0),$(`üçï Carrying pizza! Use WASD to walk carefully to Drone ${l?.drone}. Keep it level!`)},[o,at,l]),go=e.useCallback(e=>{if(l&&at)return e!==l.drone?($(`‚ùå Wrong drone! You need Drone ${l.drone}`),void bt(e=>Math.max(0,e-5))):yt<50?(ft(e),void ht(!0)):void yo(e)},[l,at,yt]),yo=e.useCallback(e=>{const t=Jt.current.drones.find(t=>t.userData.label===e);if(!t)return;const o=Jt.current.player;o&&Jt.current.playerPizza&&(o.remove(Jt.current.playerPizza),Jt.current.playerPizza=null);const n=(()=>{const e=new p,t=new c(.8,.15,.8),o=new i({color:re}),n=new r(t,o);n.castShadow=!0,e.add(n);const a=new c(.82,.05,.82),s=new i({color:16733525}),l=new r(a,s);l.position.y=.1,e.add(l);const d=new z(.2,32),u=new x({color:16763904}),h=new r(d,u);return h.rotation.x=-Math.PI/2,h.position.y=.13,e.add(h),e})();n.position.set(0,-.5,0),n.userData.isPizza=!0,t.add(n),t.userData.hasPizza=!0,t.userData.targetBase=l.base,Jt.current.currentDrone=t,Xe(e),st(!1),a("flying"),H(!0),rt("ascending"),to(null),$("üöÅ TAKEOFF! Hold SPACE to ascend to 10m cruise altitude!")},[l,at,yt]);e.useCallback((e,t)=>{if(!at)return;vt(o=>({x:Math.max(-30,Math.min(30,o.x+2*e-.05*o.x)),z:Math.max(-30,Math.min(30,o.z+2*t-.05*o.z))}));const o=Math.sqrt(zt.x**2+zt.z**2);o>20&&bt(e=>Math.max(0,e-.05*o))},[at,zt]);const bo=e.useCallback(e=>{at&&go(e)},[at,go]),zo=e.useCallback(()=>{if(!N||!Jt.current.currentDrone||!Ze)return void(Ze||$("‚ö†Ô∏è Get closer to the base! Wait for green indicator."));const e=Jt.current.currentDrone,t=e.children.find(e=>e.userData.isPizza);if(!t)return void $("‚ùå No pizza attached!");const o=(Date.now()-At)/1e3,n=yt>=95&&o<45,i=(e=>e<30?{temp:"PIPING HOT",emoji:"üî•üî•üî•",color:"#ff4400",bonus:2,penalty:0}:e<45?{temp:"HOT",emoji:"üî•üî•",color:"#ff6600",bonus:1,penalty:0}:e<60?{temp:"WARM",emoji:"üî•",color:"#ff9900",bonus:.5,penalty:0}:e<90?{temp:"LUKEWARM",emoji:"üòê",color:"#ffcc00",bonus:0,penalty:-.5}:e<120?{temp:"COOL",emoji:"‚ùÑÔ∏è",color:"#66ccff",bonus:0,penalty:-1}:{temp:"COLD",emoji:"ü•∂",color:"#0099ff",bonus:0,penalty:-2})(o),r=mt?.price||15.99,s=Pe(yt,o),l=((e,t,o,n=15.99,i=null)=>{const r=Pe(t,e),a=e>=90,s=t<70,l=t<50;if(t<30)return 0;if(e>=150&&l)return 0;if(r<1.5)return 0;let d=!1;e>=120&&!s&&(d=!0),l&&!a&&(d=!0),a&&s&&!l&&(d=!0);let p=1;const c=t>=97;r>=4.8?(p=2,c&&e<45&&(p=2.5)):r>=4.5?(p=1.7,c&&(p=2)):r>=4?(p=1.4,t>=95&&(p=1.6)):p=r>=3.5?1:r>=3?.7:r>=2.5?.3:r>=2?.1:0;let u=.15*n*p;o&&r>=4.5&&(u+=.15*n,n>=25&&(u+=5),n>=40&&(u+=10)),c&&!o&&e<60&&(u+=2),a&&u>0&&(u=Math.max(.5,.5*u)),d&&u>0&&(u=Math.max(.25,.3*u)),i&&i.tipBonus>0&&u>0&&(u+=u*i.tipBonus);return u>0&&u<.25&&(u=.25),Math.round(100*u)/100})(o,yt,n,r,Ft.rank),d=ye(s,yt,o,n,!1);e.remove(t),e.userData.hasPizza=!1,Yt.current?.isInVR&&(Yt.current.triggerHaptic("left",.8,150),Yt.current.triggerHaptic("right",.8,150),setTimeout(()=>{Yt.current.triggerHaptic("left",.5,100),Yt.current.triggerHaptic("right",.5,100)},200)),I(e=>e+l),B(e=>e+1);const p=mt?.name||"Plain Cheese";Lt(e=>{const t=Math.max(0,e.xp+d),i=e.rank,r=ge(t),a={...e.pizzaTypeDeliveries,[p]:(e.pizzaTypeDeliveries[p]||0)+1},s=n?e.perfectDeliveries+1:e.perfectDeliveries,c=e.totalTips+l,u=e.fastestDelivery?Math.min(e.fastestDelivery,o):o;if(i.name!==r.name){const o=be(i,r,t>e.xp);o&&setTimeout(()=>{Ot(o),setTimeout(()=>Ot(null),4e3)},1500)}const h={totalDeliveries:e.totalDeliveries+1,totalEarnings:e.totalEarnings+l,bestTime:e.bestTime?Math.min(e.bestTime,o):o,xp:t,rank:r,pizzaTypeDeliveries:a,perfectDeliveries:s,totalTips:c,fastestDelivery:u,badges:e.badges},x=((e,t=[])=>{const o=[],n=new Set(t.map(e=>e.id));for(const i of de)n.has(i.id)||(e.pizzaTypeDeliveries?.[i.pizzaType]||0)>=i.required&&o.push(i);for(const i of pe)!n.has(i.id)&&e.totalDeliveries>=i.deliveries&&o.push(i);for(const i of ce)!n.has(i.id)&&e.perfectDeliveries>=i.perfectDeliveries&&o.push(i);for(const i of ue)!n.has(i.id)&&e.fastestDelivery&&e.fastestDelivery<=i.fastestTime&&o.push(i);for(const i of he)!n.has(i.id)&&e.totalTips>=i.totalTips&&o.push(i);return o})(h,e.badges);return x.length>0&&(h.badges=[...e.badges,...x],setTimeout(()=>{$t(x[0]),setTimeout(()=>$t(null),4e3)},2500)),h});const c=((e,t,o,n)=>{const i=e=>e[Math.floor(Math.random()*e.length)];return 0===e?n<30?i(["ü§¨ 'Is this even pizza anymore?! GET OUT!'","üò± 'I ordered a PIZZA, not a CRIME SCENE!'","üíÄ 'My grandma could deliver better... and she's DEAD!'","üóëÔ∏è 'I've seen better looking pizzas in the GARBAGE!'","üò§ 'I'm calling your manager, your manager's manager, and the POLICE!'"]):n<50?i(["üò§ 'This pizza is DESTROYED! No tip for you!'","ü§Æ 'Did you play SOCCER with my pizza?!'","üò† 'I wanted a pizza, not a PUZZLE!'","üëé 'This is a DISASTER. Never order from here again!'","ü§¶ 'My expectations were low but HOLY...'"]):o>=120?i(["ü•∂ 'An ICE COLD pizza?! Are you kidding me?!'","‚ùÑÔ∏è 'I could have frozen a FRESH pizza faster!'","üßä 'Did you stop for a NAP on the way?!'","‚è∞ 'Did you deliver this by HORSE?!'","üò¥ 'I ordered this pizza LAST WEEK!'"]):o>=90&&n<70?i(["üò† 'Cold AND damaged?! I'm calling the manager!'","ü§Ø 'HOW did you manage to mess up THIS badly?!'","üí¢ 'You had ONE JOB!'","üò§ 'This is insulting. Just... leave.'"]):t<2?i(["üëé 'Worst delivery ever. No tip!'","üö´ 'I'd give you negative stars if I could!'","üòí 'My 5-year-old could do better!'","üí© 'This deserves the poop emoji.'"]):"üòí 'Really? No tip for this disaster.'":i(e<1?["üòê 'I guess... here's some change.'","üôÑ 'It's not GREAT, but here's something.'","üòë 'Consider this a mercy tip.'","üí≠ 'At least you showed up... barely.'"]:e<3?["üôÇ 'It was... okay. Here.'","üòå 'Decent enough. Thanks.'","üëå 'Not bad, not great. Here you go.'","ü§∑ 'Could be worse I guess.'"]:e<5?["üòä 'Not bad! Thanks!'","üëç 'Good job! Appreciate it!'","üòÑ 'Nice delivery! Here you go!'","üôå 'That was quick! Thanks!'"]:e<8?["üòÑ 'Great service! Here you go!'","üåü 'Impressive! Well done!'","üëè 'Now THAT'S how you deliver pizza!'","üî• 'Fast AND fresh! Love it!'"]:e<15?["ü§© 'AMAZING! Best delivery ever! Keep the change!'","ü•≥ 'WOW! You're a LEGEND!'","üíØ 'PERFECTION! You deserve this!'","‚≠ê 'Five stars! Tell your boss you need a raise!'","üòç 'Marry me! Just kidding... unless?'"]:["ü§ë 'INCREDIBLE! Here's a HUGE tip!'","üí∞ 'You just made my WHOLE DAY! Take ALL of this!'","üéâ 'FLAWLESS! I'm telling EVERYONE about you!'","üëë 'You're the KING/QUEEN of pizza delivery!'","üèÜ 'I've NEVER had delivery this good! Here's everything I got!'","üíé 'This is what EXCELLENCE looks like! Legendary tip for you!'"])})(l,s,o,yt),u=Ft.rank?.tipBonus||0;It({deliveryTime:o,tip:l,pizzaHealth:yt,isPerfect:n,temperature:i,rating:s,tipMessage:c,pizzaType:mt,xpChange:d,rankBonus:u,playerRank:Ft.rank}),Ct(!0),a("delivered"),H(!1),Je(null),Qe(!1),setTimeout(()=>{e.position.copy(e.userData.homePos),e.rotation.y=0,Jt.current.currentDrone=null,Jt.current.camera.position.set(0,15,30),Jt.current.camera.lookAt(0,0,0)},100)},[N,Ze,yt,At]),vo=()=>Jt.current.currentDrone?{x:Jt.current.currentDrone.position.x,z:Jt.current.currentDrone.position.z}:null;return O.jsxs("div",{style:{width:"100%",height:"100vh",position:"relative",overflow:"hidden"},children:[O.jsx("div",{ref:t,style:{width:"100%",height:"100%"}}),O.jsx(Ie,{score:P,pizzasDelivered:A,pizzasDestroyed:F,currentOrder:l,pilotMode:N,cameraView:Ye,pizzaHealth:yt,playerStats:Ft,dronePosition:vo(),currentPizzaType:mt}),N&&O.jsx(Fe,{dronePosition:vo(),targetBase:(()=>{if(!l)return null;const e=Jt.current.bases.find(e=>e.userData.baseNumber===l.base);return e?{x:e.position.x,z:e.position.z}:null})(),currentOrder:l,altitude:io,verticalSpeed:ao}),N&&O.jsxs("div",{style:{position:"absolute",top:"240px",right:"20px",width:"220px",background:"ascending"===it?"rgba(255, 165, 0, 0.9)":"descending"===it?"rgba(0, 200, 255, 0.9)":"rgba(0, 200, 0, 0.9)",padding:"10px 15px",borderRadius:"10px",color:"white",fontWeight:"bold",fontSize:"14px",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",border:"2px solid white"},children:[O.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[O.jsx("span",{style:{fontSize:"20px"},children:"ascending"===it?"üöÄ":"descending"===it?"üìç":"‚úàÔ∏è"}),O.jsxs("div",{style:{flex:1},children:[O.jsx("div",{style:{textTransform:"uppercase",letterSpacing:"1px",fontSize:"13px"},children:"ascending"===it?"TAKEOFF":"descending"===it?"LANDING":"CRUISING - FULL CONTROL"}),O.jsx("div",{style:{fontSize:"10px",opacity:.9},children:"ascending"===it?`Altitude: ${Math.round(io)}m / 10m`:"descending"===it?`Land on roof (${io.toFixed(1)}m)`:`Alt: ${io.toFixed(1)}m`})]})]}),"ascending"===it&&O.jsx("div",{style:{marginTop:"8px",width:"100%",height:"6px",background:"rgba(0,0,0,0.3)",borderRadius:"3px",overflow:"hidden"},children:O.jsx("div",{style:{width:`${Math.min(100,io/10*100)}%`,height:"100%",background:"#fff",transition:"width 0.1s"}})}),O.jsxs("div",{style:{marginTop:"8px",fontSize:"11px",opacity:.9,display:"flex",justifyContent:"space-between"},children:[O.jsx("span",{children:"‚¨ÜÔ∏è SPACE = UP"}),O.jsx("span",{children:"‚¨áÔ∏è SHIFT = DOWN"})]}),O.jsx("div",{style:{marginTop:"4px",fontSize:"12px",color:ao>0?"#00ff00":ao<0?"#ff6600":"#888"},children:ao>.5?"‚Üë‚Üë‚Üë ASCENDING":ao<-.5?"‚Üì‚Üì‚Üì DESCENDING":"‚Äî HOVER"})]}),N&&O.jsx(Le,{distanceToBase:Ue,canRelease:Ze,canDescend:et,horizontalDist:ot,altitude:io}),O.jsx(We,{message:W}),wt&&O.jsx($e,{step:jt,onNext:()=>{jt<Y.length-1?Dt(e=>e+1):(St(!1),xo())},onSkip:()=>{St(!1),xo()}}),Rt&&Pt&&O.jsx(Ve,{deliveryTime:Pt.deliveryTime,tip:Pt.tip,pizzaHealth:Pt.pizzaHealth,isPerfect:Pt.isPerfect,temperature:Pt.temperature,rating:Pt.rating,tipMessage:Pt.tipMessage,pizzaType:Pt.pizzaType,xpChange:Pt.xpChange,rankBonus:Pt.rankBonus,playerRank:Pt.playerRank,totalDeliveries:A,onNextOrder:()=>{Ct(!1),xo()},onViewLeaderboard:()=>{Ct(!1),Tt(!0)}}),O.jsx(He,{message:Nt}),O.jsx(Oe,{badge:Wt}),pt&&O.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(180, 0, 0, 0.9)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"flashRed 0.5s ease-in-out 3"},children:[O.jsxs("div",{style:{fontSize:"80px",marginBottom:"20px",animation:"shake 0.5s ease-in-out infinite"},children:[mt?.emoji||"üçï","üíÄüí∏"]}),O.jsx("h1",{style:{color:"white",fontSize:"48px",textShadow:"0 0 20px #ff0000",marginBottom:"10px",textTransform:"uppercase",letterSpacing:"5px"},children:"PIZZA DESTROYED!"}),O.jsxs("div",{style:{background:"rgba(0,0,0,0.5)",padding:"8px 20px",borderRadius:"20px",marginBottom:"10px",fontSize:"18px",color:"#ffcc00"},children:[mt?.emoji," ",mt?.name||"Pizza"]}),O.jsxs("p",{style:{color:"#ffcccc",fontSize:"20px",marginBottom:"15px",textAlign:"center",maxWidth:"500px",fontStyle:"italic"},children:['"',mt?.description||"That pizza is gone forever!",'"']}),O.jsxs("div",{style:{background:"rgba(0,0,0,0.7)",padding:"15px 30px",borderRadius:"10px",border:"3px solid "+((mt?.price||18.99)>25?"#ff0000":"#ff4444"),marginBottom:"20px"},children:[O.jsx("div",{style:{color:"#ff6666",fontSize:"16px",marginBottom:"5px"},children:"üí∏ CHARGED TO YOUR WAGES:"}),O.jsxs("div",{style:{color:(mt?.price||18.99)>25?"#ff0000":"#ff4444",fontSize:(mt?.price||18.99)>25?"42px":"36px",fontWeight:"bold"},children:["-$",(mt?.price||18.99).toFixed(2)]}),O.jsx("div",{style:{color:"#ffaaaa",fontSize:"12px"},children:(mt?.price||18.99)>=49.99?"üò± THE MOST EXPENSIVE ONE!":(mt?.price||18.99)>=24.99?"üò∞ That was a premium pizza!":(mt?.price||18.99)<15?"üòÖ At least it was cheap...":"Full price of destroyed pizza!"})]}),O.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center",marginBottom:"30px"},children:[O.jsxs("div",{style:{background:"rgba(0,0,0,0.5)",padding:"15px 25px",borderRadius:"10px",color:"white",textAlign:"center"},children:[O.jsx("div",{style:{fontSize:"14px",opacity:.8},children:"Pizzas Destroyed"}),O.jsx("div",{style:{fontSize:"36px",fontWeight:"bold"},children:F})]}),O.jsxs("div",{style:{background:"rgba(0,0,0,0.5)",padding:"15px 25px",borderRadius:"10px",color:P<0?"#ff4444":"#00ff00",textAlign:"center"},children:[O.jsx("div",{style:{fontSize:"14px",opacity:.8},children:"Total Wages"}),O.jsx("div",{style:{fontSize:"36px",fontWeight:"bold"},children:P<0?`-$${Math.abs(P).toFixed(2)}`:`$${P.toFixed(2)}`})]})]}),O.jsxs("div",{style:{display:"flex",gap:"15px"},children:[O.jsx("button",{onClick:()=>{ct(!1),fo()},style:{...qe.primary,background:"linear-gradient(180deg, #22aa22 0%, #118811 100%)",fontSize:"20px",padding:"15px 40px"},children:"üçï Try Again"}),O.jsx("button",{onClick:()=>{ct(!1),a("menu"),d(null)},style:{...qe.secondary,fontSize:"20px",padding:"15px 40px"},children:"üè† Back to Menu"})]}),O.jsx("p",{style:{color:"#ffaaaa",fontSize:"14px",marginTop:"30px",opacity:.7},children:"üí° Tip: Move slowly and keep the pizza box level!"})]}),ut&&O.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(180, 100, 0, 0.9)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:1e3},children:[O.jsx("div",{style:{fontSize:"80px",marginBottom:"20px"},children:"üçïüò¨üçï"}),O.jsx("h1",{style:{color:"white",fontSize:"36px",textShadow:"0 0 20px #ff6600",marginBottom:"10px",textAlign:"center"},children:"WAIT... DELIVER THIS?!"}),O.jsxs("p",{style:{color:"#ffeecc",fontSize:"22px",marginBottom:"10px",textAlign:"center",maxWidth:"500px"},children:["This pizza is only ",O.jsxs("span",{style:{color:"#ff4444",fontWeight:"bold",fontSize:"28px"},children:[Math.round(yt),"%"]})," intact!"]}),O.jsxs("p",{style:{color:"#ffcc88",fontSize:"18px",marginBottom:"30px",textAlign:"center",maxWidth:"500px",fontStyle:"italic"},children:['ü§î "Are you SURE you want to deliver this disaster?',O.jsx("br",{}),"The customer might not tip well... or at all...",O.jsx("br",{}),'They might even call your manager!"']}),O.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"15px 30px",borderRadius:"10px",marginBottom:"25px"},children:[O.jsx("div",{style:{color:"#ffcc00",fontSize:"16px",marginBottom:"5px"},children:"üí∞ Expected Tip Reduction:"}),O.jsxs("div",{style:{color:"#ff4444",fontSize:"24px",fontWeight:"bold"},children:["-",Math.round(.5*(100-yt)),"% tips! üò¢"]})]}),O.jsxs("div",{style:{display:"flex",gap:"15px"},children:[O.jsx("button",{onClick:()=>{ht(!1),xt&&(yo(xt),ft(null))},style:{...qe.primary,background:"linear-gradient(180deg, #cc6600 0%, #884400 100%)",fontSize:"18px",padding:"12px 30px"},children:"üòÖ YOLO! Deliver It Anyway"}),O.jsx("button",{onClick:()=>{ht(!1),ft(null),fo()},style:{...qe.secondary,fontSize:"18px",padding:"12px 30px"},children:"üçï Get Fresh Pizza"})]}),O.jsx("p",{style:{color:"#ffddaa",fontSize:"12px",marginTop:"20px",opacity:.7},children:"Pro tip: Walk back to the shop for a perfect pizza! üèÉ‚Äç‚ôÇÔ∏è"})]}),O.jsx(_e,{isOpen:kt,onClose:()=>Tt(!1),category:Mt,onCategoryChange:Et,playerRank:42,playerScore:P}),!kt&&!Rt&&"menu"!==o&&O.jsx(Ge,{topPlayers:Ce.fastest_delivery,playerRank:42,onExpand:()=>Tt(!0)}),O.jsxs("div",{style:{position:"absolute",bottom:20,left:"50%",transform:"translateX(-50%)",display:"flex",gap:"10px"},children:["menu"===o&&O.jsxs(O.Fragment,{children:[O.jsx("button",{onClick:()=>St(!0),style:qe.secondary,children:"üìñ Tutorial"}),O.jsx("button",{onClick:xo,style:qe.primary,children:"üçï Start Delivering!"}),O.jsx("button",{onClick:()=>Tt(!0),style:qe.secondary,children:"üèÜ Leaderboards"})]}),"carrying"===o&&!at&&O.jsx(O.Fragment,{children:oo?O.jsx("button",{onClick:mo,style:{...qe.primary,animation:"pulse 1s infinite"},children:"üçï Grab Pizza from Shop"}):O.jsx("div",{style:{color:"white",background:"rgba(0,0,0,0.7)",padding:"10px 20px",borderRadius:"8px"},children:"üè™ Walk to the Pizza Shop! (WASD to move)"})}),"carrying"===o&&at&&O.jsxs(O.Fragment,{children:[O.jsxs("div",{style:{color:"white",background:"rgba(0,0,0,0.7)",padding:"10px 20px",borderRadius:"8px",marginRight:"10px"},children:["üçï Walk to Drone ",l?.drone,"! (WASD to move)"]}),eo&&O.jsxs("button",{onClick:()=>go(eo),style:{...qe.primary,background:eo===l?.drone?"#22cc22":"#cc8822",animation:eo===l?.drone?"pulse 0.5s infinite":"none"},children:["üöÅ Load Drone ",eo,eo!==l?.drone&&" (Wrong!)"]})]}),"flying"===o&&N&&O.jsx("button",{onClick:zo,style:{...qe.danger,animation:Ze?"glow 1s infinite":"none"},children:"üì¶ Release Pizza"})]}),at&&O.jsx(Ae,{pizzaHealth:yt,pizzaTilt:zt}),at&&O.jsx(Be,{speed:lo,isWarning:co,pizzaHealth:yt}),N&&O.jsx(Ne,{}),O.jsx("style",{children:"\n  @keyframes blink {\n    0%, 50% { opacity: 1; }\n    51%, 100% { opacity: 0.3; }\n  }\n  \n  @keyframes pulse {\n    0%, 100% { transform: translate(-50%, -50%) scale(1); }\n    50% { transform: translate(-50%, -50%) scale(1.2); }\n  }\n  \n  @keyframes popIn {\n    0% { transform: scale(0.8); opacity: 0; }\n    100% { transform: scale(1); opacity: 1; }\n  }\n  \n  @keyframes shake {\n    0%, 100% { transform: translateX(0); }\n    25% { transform: translateX(-5px); }\n    75% { transform: translateX(5px); }\n  }\n  \n  @keyframes glow {\n    0%, 100% { box-shadow: 0 0 5px #00ff00; }\n    50% { box-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00; }\n  }\n  \n  @keyframes slideIn {\n    0% { transform: translateY(-100%); opacity: 0; }\n    100% { transform: translateY(0); opacity: 1; }\n  }\n  \n  @keyframes fadeIn {\n    0% { opacity: 0; }\n    100% { opacity: 1; }\n  }\n  \n  @keyframes bounce {\n    0%, 100% { transform: translateY(0); }\n    50% { transform: translateY(-10px); }\n  }\n  \n  @keyframes rotate {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @keyframes warning {\n    0%, 100% { background-color: rgba(255, 0, 0, 0.2); }\n    50% { background-color: rgba(255, 0, 0, 0.5); }\n  }\n  \n  .game-button {\n    transition: all 0.2s ease;\n  }\n  \n  .game-button:hover {\n    transform: scale(1.05);\n    box-shadow: 0 6px 12px rgba(0,0,0,0.4);\n  }\n  \n  .game-button:active {\n    transform: scale(0.98);\n  }\n"})]})};function Ye(){return O.jsx("div",{className:"App",children:O.jsx(Xe,{})})}H.createRoot(document.getElementById("root")).render(O.jsx(o.StrictMode,{children:O.jsx(Ye,{})}));
